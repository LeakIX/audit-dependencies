# Security Audit: Uvicorn v0.40.0

**Package**: [uvicorn](https://pypi.org/project/uvicorn/)
**Version**: 0.40.0
**Audit Date**: 2026-02-01
**Language**: Python

## Package Information

| Field | Value |
|-------|-------|
| Author | Tom Christie |
| License | BSD-3-Clause |
| Repository | https://github.com/Kludex/uvicorn |
| Documentation | https://uvicorn.dev/ |
| Python Support | >=3.9 |

## Description

Uvicorn is a lightning-fast ASGI (Asynchronous Server Gateway Interface) server
implementation for Python. It provides high-performance HTTP/1.1 and WebSocket
protocol support, making it ideal for running async web frameworks like FastAPI,
Starlette, and other ASGI applications.

## Dependencies

Core dependencies:

- `click` (>=7.0) - CLI interface
- `h11` (>=0.8) - HTTP/1.1 implementation
- `typing-extensions` (>=4.0) - Type hints backport (Python < 3.11)

Optional dependencies (standard extras):

- `httptools` (>=0.6.3) - Fast HTTP parsing
- `uvloop` (>=0.15.1) - Fast event loop (non-Windows, non-PyPy)
- `watchfiles` (>=0.13) - File watching for auto-reload
- `websockets` (>=10.4) - WebSocket support
- `python-dotenv` (>=0.13) - Environment file support
- `pyyaml` (>=5.1) - YAML configuration
- `colorama` (>=0.4) - Colored output (Windows)

## Security Assessment

### Current Status: SAFE

Version 0.40.0 has no known unpatched vulnerabilities. All historical CVEs have
been addressed in versions prior to 0.11.7.

## Historical Vulnerabilities

### CVE-2020-7695 - HTTP Response Splitting

| Field | Value |
|-------|-------|
| Severity | MEDIUM (CVSS 5.3 NVD / 8.7 GitHub) |
| Type | HTTP Response Splitting |
| Affected Versions | < 0.11.7 |
| Fixed Version | 0.11.7 |
| Fixed | Yes (in 0.40.0) |
| CWE | CWE-74 (Improper Neutralization of Special Elements) |

**Description**: Uvicorn's implementation of the HTTP protocol for the httptools
parser was vulnerable to HTTP response splitting attacks. CRLF (Carriage Return
Line Feed) sequences were not properly escaped in HTTP header values, allowing
attackers to inject arbitrary headers or alter response bodies when crafted
input was used to construct HTTP headers.

**Attack Vector**: Attackers could exploit this vulnerability to:

- Inject arbitrary HTTP headers into responses
- Perform cache poisoning attacks
- Execute cross-site scripting (XSS) via injected content
- Manipulate response bodies

**Fix**: The vulnerability was addressed by properly escaping CRLF sequences in
HTTP header values.

**References**:

- [NVD - CVE-2020-7695](https://nvd.nist.gov/vuln/detail/CVE-2020-7695)
- [GitHub Advisory GHSA-f97h-2pfx-f59f](https://github.com/advisories/GHSA-f97h-2pfx-f59f)
- [Snyk - SNYK-PYTHON-UVICORN-570471](https://security.snyk.io/vuln/SNYK-PYTHON-UVICORN-570471)

---

### CVE-2020-7694 - Log Injection (ANSI Escape Sequence)

| Field | Value |
|-------|-------|
| Severity | LOW (CVSS 3.7 Snyk) / HIGH (CVSS 7.5 NVD) |
| Type | Log Injection |
| Affected Versions | < 0.11.7 |
| Fixed Version | 0.11.7 |
| Fixed | Yes (in 0.40.0) |
| CWE | CWE-94 (Code Injection), CWE-116 (Improper Encoding) |

**Description**: Uvicorn's request logger was vulnerable to ANSI escape sequence
injection. Attackers could craft URLs with percent-encoded escape sequences
that, when logged, would pollute access logs and potentially interact with
terminal emulators displaying those logs.

**Attack Vector**: An attacker could:

- Pollute server access logs with malicious content
- Potentially exploit terminal emulator vulnerabilities
- Manipulate log output for social engineering or covering tracks
- Compromise log integrity for forensic analysis

**Note**: There is a discrepancy in severity ratings between Snyk (3.7 LOW) and
NVD (7.5 HIGH). The lower Snyk score reflects the limited real-world impact,
while NVD's higher score considers theoretical maximum impact.

**References**:

- [NVD - CVE-2020-7694](https://nvd.nist.gov/vuln/detail/CVE-2020-7694)
- [Snyk - SNYK-PYTHON-UVICORN-575560](https://security.snyk.io/vuln/SNYK-PYTHON-UVICORN-575560)

## Configuration Security Considerations

### Auto-Reload in Production

**Warning**: Never enable auto-reload (`--reload`) in production environments.
Auto-reload monitors files for changes and restarts the server automatically.
If an attacker gains file write access, they can achieve remote code execution
by modifying Python files.

**Recommendation**: Use `--reload` only in development. For production, use
process managers like systemd or supervisord.

### Host Binding

**Warning**: Binding to `0.0.0.0` exposes the server to all network interfaces.

**Recommendation**: In production behind a reverse proxy:

```bash
uvicorn app:app --host 127.0.0.1 --port 8000
```

### SSL/TLS Configuration

For direct HTTPS (not behind a reverse proxy):

```bash
uvicorn app:app --ssl-keyfile=key.pem --ssl-certfile=cert.pem
```

**Recommendation**: Prefer running uvicorn behind a reverse proxy (nginx, Caddy)
that handles TLS termination.

## Dependency Security Notes

### h11 (HTTP/1.1 Implementation)

The h11 library handles low-level HTTP parsing. Keep it updated to benefit from
any security patches in HTTP protocol handling.

### httptools (Optional)

The httptools library provides faster HTTP parsing via C extensions. It is based
on the Node.js HTTP parser. Monitor for any security updates.

### uvloop (Optional)

uvloop is a fast drop-in replacement for asyncio's event loop. It is built on
libuv. Security updates should be monitored as it handles low-level I/O.

## Recommendations

1. **Version 0.40.0 is safe to use** - All known vulnerabilities have been
   patched since version 0.11.7.

2. **Keep dependencies updated** - Regularly update uvicorn and its dependencies
   to receive security patches.

3. **Production deployment best practices**:
   - Never use `--reload` in production
   - Bind to localhost when behind a reverse proxy
   - Use a reverse proxy (nginx, Caddy) for TLS termination
   - Implement proper logging and monitoring
   - Set appropriate resource limits (workers, connections)

4. **Security hardening**:
   - Run uvicorn as a non-root user
   - Use process isolation (containers, systemd)
   - Configure appropriate timeouts
   - Implement rate limiting at the reverse proxy level

5. **Monitoring**:
   - Monitor access logs for suspicious patterns
   - Set up alerts for unusual traffic patterns
   - Regularly review security advisories

## Audit Sources

- [Snyk Vulnerability Database - uvicorn](https://security.snyk.io/package/pip/uvicorn)
- [NVD - National Vulnerability Database](https://nvd.nist.gov/)
- [GitHub Security Advisories](https://github.com/advisories?query=uvicorn)
- [CVE Details - Uvicorn](https://www.cvedetails.com/product/92370/Encode-Uvicorn.html)
- [PyPI - uvicorn](https://pypi.org/project/uvicorn/)
