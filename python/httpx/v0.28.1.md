# Security Audit: httpx v0.28.1

**Package**: httpx
**Version**: 0.28.1 (latest)
**Language**: Python
**Audit Date**: 2026-02-01

## Package Information

| Field | Value |
|-------|-------|
| Name | httpx |
| Version | 0.28.1 |
| Author | Tom Christie |
| License | BSD-3-Clause |
| Homepage | https://www.python-httpx.org |
| Repository | https://github.com/encode/httpx |
| PyPI | https://pypi.org/project/httpx/ |
| Python Requirement | >= 3.8 |

## Summary

The `httpx` library is a modern, fully-featured HTTP client for Python 3,
supporting HTTP/1.1 and HTTP/2, with both synchronous and asynchronous APIs. It
is developed by Encode OSS (Tom Christie) and serves as the "next generation"
alternative to the `requests` library.

**Recommendation**: SAFE to use at version 0.28.1

Version 0.28.1 (released December 6, 2024) is the latest stable release and
addresses all known security vulnerabilities. The primary vulnerability
(CVE-2021-41945) was fixed in version 0.23.0 (May 23, 2022).

## Known Vulnerabilities

### CVE-2021-41945 - Improper Input Validation / SSRF (2022)

| Field | Value |
|-------|-------|
| CVE ID | CVE-2021-41945 |
| GHSA ID | GHSA-h8pj-cxx2-jfg2 |
| Snyk ID | SNYK-PYTHON-HTTPX-2772742, SNYK-PYTHON-HTTPX-2805813 |
| Severity | Critical |
| CVSS v3.1 | 9.1 (Critical) |
| CVSS v4 | 9.3 (Critical) |
| CVSS v2 | 6.4 (Medium) |
| CWE | CWE-20 (Improper Input Validation) |
| Affected Versions | < 0.23.0 |
| Fixed Version | 0.23.0 |
| Published | April 28, 2022 |
| Last Modified | November 21, 2024 |

**Description**: Encode OSS httpx versions before 0.23.0 are affected by
improper input validation in `httpx.URL`, `httpx.Client`, and some functions
using `httpx.URL.copy_with`. The vulnerability allows Server-Side Request
Forgery (SSRF) attacks through malformed URLs.

**Attack Vector Analysis**:

| Metric | Value |
|--------|-------|
| Attack Vector | Network |
| Attack Complexity | Low |
| Privileges Required | None |
| User Interaction | None |
| Scope | Unchanged |
| Confidentiality Impact | High |
| Integrity Impact | High |
| Availability Impact | None |

**Technical Details**: The vulnerability exists in the URL parsing mechanism.
When using `httpx.URL().copy_with`, the library incorrectly parses certain
malformed URLs, causing `httpx.Client` and `httpx.Proxy` to connect to
unintended hosts. This can lead to:

- Blacklist/blocklist bypass
- Server-Side Request Forgery (SSRF)
- Credential theft (if credentials are sent to attacker-controlled servers)
- Access to internal network resources

**Proof of Concept**: A proof-of-concept demonstrating the vulnerability is
available at:
https://gist.github.com/lebr0nli/4edb76bbd3b5ff993cf44f2fbce5e571

**Remediation**: Upgrade httpx to version 0.23.0 or later.

**References**:
- https://nvd.nist.gov/vuln/detail/CVE-2021-41945
- https://github.com/advisories/GHSA-h8pj-cxx2-jfg2
- https://security.snyk.io/vuln/SNYK-PYTHON-HTTPX-2772742
- https://security.snyk.io/vuln/SNYK-PYTHON-HTTPX-2805813
- https://github.com/encode/httpx/issues/2184
- https://github.com/encode/httpx/releases/tag/0.23.0

---

## Malicious Package Warning

### httpx-advanced2 (Dependency Confusion Attack)

| Field | Value |
|-------|-------|
| Snyk ID | SNYK-PYTHON-HTTPXADVANCED2-5295879 |
| Type | Malicious Package |
| Status | Active threat |

**Description**: The `httpx-advanced2` package is a malicious package that
attempts to compromise users through dependency confusion techniques. This is
NOT the legitimate httpx package but uses a similar name to deceive developers.

**Warning**: Never install packages with names similar to `httpx` (such as
`httpx-advanced2`, `python-httpx`, etc.) without verifying the package source.
Always use the official `httpx` package from PyPI.

---

## Version History (Security-Relevant)

| Version | Release Date | Security Changes |
|---------|--------------|------------------|
| 0.28.1 | 2024-12-06 | Current stable release |
| 0.23.0 | 2022-05-23 | Fixed CVE-2021-41945 (SSRF/Input Validation) |

## Security Policy

The httpx project has a security policy for responsible disclosure:

- **Reporting**: Navigate to the Security tab on the GitHub repository and
  click "Report a vulnerability"
- **Do not** open public issues for security vulnerabilities
- Include detailed reproduction steps and minimal reproducible examples
- Security policy URL: https://github.com/encode/httpx/security

**Note**: Snyk indicates that httpx is missing a formal SECURITY.md file, but
GitHub's private vulnerability reporting is enabled.

## Dependencies

Core dependencies:
- `anyio` - Async compatibility layer
- `certifi` - CA certificate bundle
- `httpcore==1.*` - HTTP transport layer
- `idna` - Internationalized domain names

Optional extras:
- `h2` (http2) - HTTP/2 support
- `click`, `pygments`, `rich` (cli) - Command-line interface
- `socksio` (socks) - SOCKS proxy support
- `brotli`/`brotlicffi` (brotli) - Brotli decompression
- `zstandard` (zstd) - Zstandard decompression

Consider auditing `httpcore` as it handles the low-level HTTP transport.

## Security Best Practices

When using the `httpx` library:

1. **Always use the latest version** (currently 0.28.1)
2. **Verify SSL certificates** - Never use `verify=False` in production
3. **Validate URLs** - Sanitize and validate all user-supplied URLs before
   making requests
4. **Use timeouts** - Always set appropriate timeouts to prevent hanging
5. **Handle redirects carefully** - Consider limiting redirect count or
   disabling automatic redirects for sensitive requests
6. **Review proxy configurations** - Ensure proxy credentials are handled
   securely
7. **Avoid typosquatting packages** - Only install the official `httpx` package

## Comparison with requests

Both `httpx` and `requests` have had credential/URL handling vulnerabilities.
Key differences:

| Feature | httpx | requests |
|---------|-------|----------|
| HTTP/2 Support | Yes | No |
| Async Support | Native | No (requires aiohttp) |
| Known CVEs | 1 | 7+ |
| Latest Security Fix | 2022-05 | 2024-09 |

## Sources

- [PyPI - httpx](https://pypi.org/project/httpx/)
- [GitHub - encode/httpx](https://github.com/encode/httpx)
- [Documentation - python-httpx.org](https://www.python-httpx.org)
- [NVD - CVE-2021-41945](https://nvd.nist.gov/vuln/detail/CVE-2021-41945)
- [GitHub Advisory - GHSA-h8pj-cxx2-jfg2](https://github.com/advisories/GHSA-h8pj-cxx2-jfg2)
- [Snyk - httpx vulnerabilities](https://security.snyk.io/package/pip/httpx)
- [Snyk - httpx package health](https://snyk.io/advisor/python/httpx)
