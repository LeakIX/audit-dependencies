# Security Audit: FastAPI v0.128.0

**Package**: [fastapi](https://pypi.org/project/fastapi/)
**Version**: 0.128.0
**Audit Date**: 2026-02-01
**Language**: Python

## Package Information

| Field | Value |
|-------|-------|
| Author | Sebastian Ramirez (tiangolo) |
| License | MIT |
| Repository | https://github.com/fastapi/fastapi |
| Documentation | https://fastapi.tiangolo.com/ |
| Release Date | 2024-12-27 |
| Python Support | >=3.9 |

## Description

FastAPI is a modern, high-performance web framework for building APIs with
Python based on standard Python type hints. It provides automatic interactive
API documentation (Swagger UI and ReDoc), high performance comparable to
NodeJS and Go, and developer-friendly features.

## Dependencies

Key dependencies:

- `starlette` (>=0.40.0, <0.51.0) - ASGI framework
- `pydantic` (>=2.7.0) - Data validation
- `typing-extensions` (>=4.8.0) - Type hints backport

Optional dependencies (standard extras):

- `uvicorn[standard]` (>=0.12.0) - ASGI server
- `fastapi-cli[standard]` (>=0.0.8) - CLI tool
- `httpx`, `jinja2`, `python-multipart`, `email-validator`

## Security Assessment

### Current Status: SAFE

Version 0.128.0 has no known unpatched vulnerabilities. All historical CVEs
have been addressed.

## Historical Vulnerabilities

### CVE-2024-24762 - Regular Expression Denial of Service (ReDoS)

| Field | Value |
|-------|-------|
| Severity | HIGH (CVSS 7.5) |
| Type | ReDoS via python-multipart |
| Affected Versions | < 0.109.1 |
| Fixed Version | 0.109.1 |
| Fixed | Yes (in 0.128.0) |

**Description**: The vulnerability exists in python-multipart's parsing of the
HTTP Content-Type header. An attacker could send a crafted Content-Type option
that causes the regex parser to consume excessive CPU resources, stalling the
event loop and preventing request handling.

**References**:

- [NVD - CVE-2024-24762](https://nvd.nist.gov/vuln/detail/cve-2024-24762)
- [GitHub Advisory GHSA-2jv5-9r88-3w3p](https://github.com/advisories/GHSA-2jv5-9r88-3w3p)
- [Snyk - SNYK-PYTHON-FASTAPI-6228055](https://security.snyk.io/vuln/SNYK-PYTHON-FASTAPI-6228055)

---

### CVE-2021-32677 - Cross-Site Request Forgery (CSRF)

| Field | Value |
|-------|-------|
| Severity | MEDIUM (CVSS 4.6) |
| Type | CSRF via JSON parsing |
| Affected Versions | < 0.65.2 |
| Fixed Version | 0.65.2 |
| Fixed | Yes (in 0.128.0) |

**Description**: FastAPI versions below 0.65.2 would parse request payloads as
JSON even when the Content-Type header was set to `text/plain`. Since
`text/plain` requests are exempt from CORS preflight checks (considered "simple
requests"), browsers would execute them immediately including cookies. An
attacker could craft a `text/plain` request containing a JSON payload to
perform CSRF attacks.

**Fix**: Request data is now parsed as JSON only if the Content-Type header is
`application/json` or another JSON-compatible media type.

**References**:

- [NVD - CVE-2021-32677](https://nvd.nist.gov/vuln/detail/CVE-2021-32677)
- [GitHub Advisory GHSA-8h2j-cgx8-6xv7](https://github.com/advisories/GHSA-8h2j-cgx8-6xv7)
- [Snyk - SNYK-PYTHON-FASTAPI-1303092](https://security.snyk.io/vuln/SNYK-PYTHON-FASTAPI-1303092)

---

### Information Leakage (No CVE Assigned)

| Field | Value |
|-------|-------|
| Severity | MEDIUM (CVSS 5.3) |
| Type | Information Leakage |
| Affected Versions | < 0.37.0 |
| Fixed Version | 0.37.0 |
| Fixed | Yes (in 0.128.0) |
| CWE | CWE-200 |

**Description**: When returning a sub-class of a response model and using
`skip_defaults`, FastAPI could inadvertently leak information from the
sub-class that should not have been included in the response.

**References**:

- [Snyk - SNYK-PYTHON-FASTAPI-569038](https://security.snyk.io/vuln/SNYK-PYTHON-FASTAPI-569038)

## Dependency Vulnerabilities to Monitor

### CVE-2024-47874 - Starlette Multipart DoS

| Field | Value |
|-------|-------|
| Severity | HIGH (CVSS 8.7) |
| Package | starlette |
| Affected Versions | < 0.40.0 |
| Fixed Version | 0.40.0 |
| Status | Mitigated via dependency constraint |

**Description**: Starlette versions prior to 0.40.0 are vulnerable to Denial of
Service via multipart/form-data requests. Parts without a filename are treated
as text form fields and buffered without size limits, allowing attackers to
exhaust server memory.

**Impact on FastAPI**: FastAPI 0.128.0 requires `starlette>=0.40.0`, which
includes the fix. Users are protected as long as they update starlette when
installing FastAPI.

**References**:

- [NVD - CVE-2024-47874](https://nvd.nist.gov/vuln/detail/cve-2024-47874)
- [Snyk - SNYK-PYTHON-STARLETTE-8186175](https://security.snyk.io/vuln/SNYK-PYTHON-STARLETTE-8186175)

## Related Package Vulnerabilities (Not FastAPI Core)

These vulnerabilities affect FastAPI ecosystem packages, not FastAPI itself:

### CVE-2025-14546 - fastapi-sso CSRF

- **Package**: fastapi-sso (separate package)
- **Affected**: < 0.19.0
- **Fixed**: 0.19.0
- **Description**: CSRF via improper OAuth state parameter validation

### CVE-2025-54365 - fastapi-guard Regex Bypass

- **Package**: fastapi-guard (separate package)
- **Affected**: 3.0.1
- **Fixed**: 3.0.2
- **Description**: Regex bypass allowing XSS and SQL injection

## Recommendations

1. **Version 0.128.0 is safe to use** - All known vulnerabilities have been
   patched.

2. **Keep dependencies updated** - Ensure starlette is at least 0.40.0 to
   mitigate CVE-2024-47874.

3. **Monitor ecosystem packages** - If using fastapi-sso or fastapi-guard,
   ensure they are updated to patched versions.

4. **Security best practices**:
   - Always validate and sanitize user input
   - Use HTTPS in production
   - Implement proper authentication and authorization
   - Set appropriate CORS policies
   - Consider rate limiting for public APIs

## Audit Sources

- [Snyk Vulnerability Database](https://security.snyk.io/package/pip/fastapi)
- [NVD - National Vulnerability Database](https://nvd.nist.gov/)
- [GitHub Security Advisories](https://github.com/fastapi/fastapi/security)
- [CVE Details - FastAPI](https://www.cvedetails.com/product/97031/Fastapi-Project-Fastapi.html)
- [PyPI - fastapi](https://pypi.org/project/fastapi/)
