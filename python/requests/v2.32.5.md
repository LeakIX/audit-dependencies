# Security Audit: requests v2.32.5

**Package**: requests
**Version**: 2.32.5 (latest)
**Language**: Python
**Audit Date**: 2026-02-01

## Package Information

| Field | Value |
|-------|-------|
| Name | requests |
| Version | 2.32.5 |
| Author | Kenneth Reitz |
| License | Apache-2.0 |
| Homepage | https://requests.readthedocs.io |
| Repository | https://github.com/psf/requests |
| PyPI | https://pypi.org/project/requests/ |

## Summary

The `requests` library is one of the most popular Python packages for HTTP
requests, with approximately 30 million weekly downloads. Version 2.32.5 is the
latest release and addresses all known security vulnerabilities.

**Recommendation**: SAFE to use at version 2.32.5

## Known Vulnerabilities

### CVE-2024-47081 - Netrc Credential Leak (2024)

| Field | Value |
|-------|-------|
| CVE ID | CVE-2024-47081 |
| Severity | Medium |
| CVSS Score | 5.3 |
| CWE | CWE-522 (Insufficiently Protected Credentials) |
| Affected Versions | < 2.32.4 |
| Fixed Version | 2.32.4 |

**Description**: The requests library leaks .netrc credentials to third parties
due to incorrect URL processing. When making requests to maliciously crafted
URLs (e.g., `http://example.com:@evil.com/`), the library incorrectly handles
netloc parsing, causing .netrc credentials configured for the first domain to
be leaked to the second domain.

**Workaround**: Disable .netrc access using `trust_env=False` on the Requests
Session, or explicitly specify credentials on every API call.

**References**:
- https://github.com/psf/requests/issues/6964
- https://ubuntu.com/security/CVE-2024-47081
- https://www.wiz.io/vulnerability-database/cve/cve-2024-47081

---

### CVE-2024-35195 - Session verify=False Persistence (2024)

| Field | Value |
|-------|-------|
| CVE ID | CVE-2024-35195 |
| Severity | Medium |
| CVSS Score | 5.6 |
| CWE | CWE-670 (Always-Incorrect Control Flow Implementation) |
| Affected Versions | < 2.32.0 |
| Fixed Version | 2.32.2 |

**Description**: When making requests through a Requests `Session`, if the first
request is made with `verify=False` to disable cert verification, all subsequent
requests to the same host will continue to ignore cert verification regardless
of changes to the value of `verify`. This behavior continues for the lifecycle
of the connection in the connection pool.

**Note**: Version 2.32.0 was yanked due to regressions. Use 2.32.2 or later.

**Workaround**: For versions < 2.32.0, avoid setting `verify=False` for the
first request to a host while using a Session, or call `close()` on Session
objects to clear existing connections.

**References**:
- https://github.com/advisories/GHSA-9wx4-h78v-vm56
- https://ubuntu.com/security/CVE-2024-35195
- https://security.snyk.io/vuln/SNYK-PYTHON-REQUESTS-6928867

---

### CVE-2023-32681 - Proxy-Authorization Header Leak (2023)

| Field | Value |
|-------|-------|
| CVE ID | CVE-2023-32681 |
| GHSA ID | GHSA-j8r2-6x86-q33q |
| Severity | Moderate |
| CVSS Score | 6.1 |
| CWE | CWE-200 (Information Exposure) |
| Affected Versions | >= 2.3.0, < 2.31.0 |
| Fixed Version | 2.31.0 |

**Description**: Since Requests 2.3.0, the library has been leaking
Proxy-Authorization headers to destination servers when redirected to an HTTPS
endpoint. For HTTPS connections through proxies, the Proxy-Authorization header
must be sent in the CONNECT request. The library's redirect mechanism
inadvertently forwards this header to destination servers.

**Affected Redirect Scenarios**:
- HTTP -> HTTPS: credentials leak
- HTTPS -> HTTPS: credentials leak
- HTTP -> HTTP: no leak
- HTTPS -> HTTP: no leak

**Workaround**: Disable redirects via `allow_redirects=False` in API calls.
Users who don't use a proxy or don't supply proxy credentials through the URL
are not affected.

**References**:
- https://github.com/advisories/GHSA-j8r2-6x86-q33q
- https://bugzilla.redhat.com/show_bug.cgi?id=2209469

---

### CVE-2018-18074 - Authorization Header Leak on HTTPS->HTTP Redirect (2018)

| Field | Value |
|-------|-------|
| CVE ID | CVE-2018-18074 |
| Severity | Moderate |
| CVSS Score | 7.5 (High) |
| Affected Versions | < 2.20.0 |
| Fixed Version | 2.20.0 |

**Description**: The Requests package before 2.20.0 sends an HTTP Authorization
header to an http URI upon receiving a same-hostname https-to-http redirect.
This makes it easier for remote attackers to discover credentials by sniffing
network traffic.

**References**:
- https://nvd.nist.gov/vuln/detail/CVE-2018-18074
- https://bugzilla.redhat.com/show_bug.cgi?id=1643829

---

### CVE-2015-2296 - Session Fixation via Cookie Handling (2015)

| Field | Value |
|-------|-------|
| CVE ID | CVE-2015-2296 |
| GHSA ID | GHSA-pg2w-x9wp-vw92 |
| Severity | Medium |
| CVSS Score | 6.8 |
| Affected Versions | >= 2.1.0, < 2.6.0 |
| Fixed Version | 2.6.0 |

**Description**: The `resolve_redirects` function in `sessions.py` allows remote
attackers to conduct session fixation attacks via a cookie without a host value
in a redirect. A cookie without a host value set would use the hostname for the
redirected URL, exposing users to session fixation attacks and potentially
cookie stealing.

**References**:
- https://nvd.nist.gov/vuln/detail/CVE-2015-2296
- https://github.com/advisories/GHSA-pg2w-x9wp-vw92

---

### CVE-2014-1829 - Netrc Password Leak on Redirect (2014)

| Field | Value |
|-------|-------|
| CVE ID | CVE-2014-1829 |
| Severity | Medium |
| Affected Versions | < 2.3.0 |
| Fixed Version | 2.3.0 |

**Description**: Requests before 2.3.0 allows remote servers to obtain a netrc
password by reading the Authorization header in a redirected request.

**References**:
- https://www.cvedetails.com/cve/CVE-2014-1829/

---

### CVE-2014-1830 - Proxy-Authorization Header Leak on Redirect (2014)

| Field | Value |
|-------|-------|
| CVE ID | CVE-2014-1830 |
| Severity | Medium |
| Affected Versions | < 2.3.0 |
| Fixed Version | 2.3.0 |

**Description**: Requests before 2.3.0 allows remote servers to obtain sensitive
information by reading the Proxy-Authorization header in a redirected request.
An attacker-controlled server could potentially intercept and read sensitive
data, such as authentication credentials.

**References**:
- https://vulert.com/vuln-db/pypi-requests-15278

---

## Version History (Security-Relevant)

| Version | Security Changes |
|---------|------------------|
| 2.32.5 | Current stable release |
| 2.32.4 | Fixed CVE-2024-47081 (netrc credential leak) |
| 2.32.2 | Fixed CVE-2024-35195 (verify=False persistence) |
| 2.31.0 | Fixed CVE-2023-32681 (Proxy-Authorization leak) |
| 2.20.0 | Fixed CVE-2018-18074 (Authorization header leak) |
| 2.6.0 | Fixed CVE-2015-2296 (session fixation) |
| 2.3.0 | Fixed CVE-2014-1829, CVE-2014-1830 |

## Security Best Practices

When using the `requests` library:

1. **Always use the latest version** (currently 2.32.5)
2. **Verify SSL certificates** - Never use `verify=False` in production
3. **Be cautious with .netrc files** - Consider using `trust_env=False`
4. **Handle redirects carefully** - Consider `allow_redirects=False` for
   sensitive requests
5. **Don't embed credentials in URLs** - Use session auth or headers instead
6. **Review proxy configurations** - Ensure proxy credentials are handled
   securely

## Dependency Analysis

The `requests` library has the following notable dependencies:
- `urllib3` - HTTP client (also has its own CVE history)
- `certifi` - CA certificate bundle
- `charset-normalizer` - Character encoding detection
- `idna` - Internationalized domain names

Consider auditing these dependencies as well.

## Sources

- [PyPI - requests](https://pypi.org/project/requests/)
- [GitHub - psf/requests](https://github.com/psf/requests)
- [Snyk - requests vulnerabilities](https://security.snyk.io/package/pip/requests)
- [CVE Details - Python Requests](https://www.cvedetails.com/product/29258/Python-Requests.html)
- [GitHub Advisory Database](https://github.com/advisories?query=requests)
