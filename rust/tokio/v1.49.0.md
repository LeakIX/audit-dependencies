# Security Audit: tokio v1.49.0

**Audit Date**: 2026-02-01
**Auditor**: Claude (AI-assisted)
**Risk Level**: LOW

## Summary

Tokio is the de facto standard async runtime for Rust with over 510 million
downloads. While it has had 4 security advisories, all have been patched and
version 1.49.0 addresses all known vulnerabilities. The project demonstrates
excellent maintenance with active development, comprehensive CI, and a strong
security response track record.

## Package Identity

| Field        | Value                                   |
| ------------ | --------------------------------------- |
| Registry     | https://crates.io/crates/tokio          |
| Repository   | https://github.com/tokio-rs/tokio       |
| License      | MIT                                     |
| Maintainers  | Alice Ryhl (Darksonn), Carl Lerche, Eliza Weisman |
| Last Release | 2026-01-03 (v1.49.0)                    |
| Downloads    | 510,629,397 total / 79,268,131 recent   |
| Created      | 2016-07-01                              |
| Versions     | 180 releases                            |

## Vulnerabilities

### Known CVEs

| CVE ID          | RustSec ID        | Severity | Status  | Fixed In  |
| --------------- | ----------------- | -------- | ------- | --------- |
| CVE-2023-22466  | RUSTSEC-2023-0001 | Medium   | PATCHED | >= 1.23.1 |
| CVE-2021-45710  | RUSTSEC-2021-0124 | Medium   | PATCHED | >= 1.13.1 |

### Security Advisories

#### RUSTSEC-2025-0023 - Broadcast channel clone unsoundness

- **Type**: Unsoundness (INFO)
- **Affected**: 0.2.5 - 1.44.1
- **Patched**: >= 1.44.2
- **Description**: Broadcast channel calls `clone` in parallel but only requires
  `Send`, not `Sync`. This can cause unsoundness with `Send + !Sync` types.
- **Impact**: Low - requires unusual type combinations
- **Status**: PATCHED in 1.49.0

#### RUSTSEC-2023-0005 - ReadHalf::unsplit unsoundness

- **Type**: Unsoundness (INFO)
- **Affected**: 0.2.0 - 1.24.1
- **Patched**: >= 1.24.2
- **Description**: The `unsplit` method violates Rust's `Pin` contract.
- **Impact**: Low - requires `!Unpin` type with `io-util` feature
- **Status**: PATCHED in 1.49.0

#### RUSTSEC-2023-0001 - Named pipe configuration corruption (Windows)

- **Type**: Configuration vulnerability
- **CVE**: CVE-2023-22466
- **Affected**: 1.7.0 - 1.23.0
- **Patched**: >= 1.23.1
- **Description**: `reject_remote_clients` setting overridden when `pipe_mode`
  is configured on Windows named pipes.
- **Impact**: Medium - Windows only, allows remote client connections
- **Status**: PATCHED in 1.49.0

#### RUSTSEC-2021-0124 - Oneshot channel data race

- **Type**: Memory corruption
- **CVE**: CVE-2021-45710
- **Affected**: 0.1.14 - 1.13.0
- **Patched**: >= 1.13.1
- **Description**: Data race when sending/receiving after closing oneshot
  channel via `close()` method.
- **Impact**: Medium - can cause memory corruption
- **Status**: PATCHED in 1.49.0

## Supply Chain Analysis

- **Build Process**: Pure Rust crate, no build scripts with external downloads
- **Binary Artifacts**: None - source-only distribution
- **Reproducible Builds**: Yes - standard Cargo build process
- **Code Signing**: Crates.io cryptographic verification
- **Provenance**: Well-established tokio-rs organization

## Dependency Tree

### Direct Dependencies (Runtime)

| Dependency       | Version  | Optional | Purpose                    |
| ---------------- | -------- | -------- | -------------------------- |
| pin-project-lite | ^0.2.11  | No       | Pin projection (core dep)  |
| bytes            | ^1.2.1   | Yes      | Byte buffer utilities      |
| mio              | ^1.0.1   | Yes      | I/O event loop             |
| parking_lot      | ^0.12.0  | Yes      | Synchronization primitives |
| tokio-macros     | ~2.6.0   | Yes      | Proc macros                |
| socket2          | ^0.6.0   | Yes      | Socket utilities           |
| libc             | ^0.2.168 | Yes      | Unix FFI (Unix only)       |
| windows-sys      | ^0.61    | Yes      | Windows FFI (Windows only) |
| tracing          | ^0.1.29  | Yes      | Diagnostics (unstable)     |

### Notable Observations

- Only 1 required dependency (`pin-project-lite`)
- Most dependencies are optional, controlled by feature flags
- Platform-specific dependencies properly gated
- All dependencies are well-established, audited crates

## Maintenance Health

| Metric          | Status                           |
| --------------- | -------------------------------- |
| Last commit     | 2026-01-30                       |
| Last release    | 2026-01-03 (4 weeks ago)         |
| Open issues     | 390                              |
| Stars           | 30,952                           |
| Forks           | 2,903                            |
| Age             | 9+ years (since 2016)            |
| CI/CD           | Yes (GitHub Actions)             |
| Security Policy | Yes (responsible disclosure)     |
| Funding         | Tokio project / community funded |

## Recommendations

1. **Use version 1.49.0 or later** - All known vulnerabilities are patched
2. **Enable only needed features** - Minimize attack surface by disabling unused
   features (`full` feature enables everything)
3. **Monitor RustSec** - Subscribe to advisories for ongoing monitoring
4. **Review `parking_lot` usage** - If using `parking_lot` feature, ensure it's
   also up to date

## Risk Factors

| Factor                    | Assessment |
| ------------------------- | ---------- |
| Maintenance abandonment   | Very Low   |
| Supply chain compromise   | Very Low   |
| Unpatched vulnerabilities | None       |
| Dependency risk           | Low        |
| Platform-specific issues  | Low        |

### Mitigating Factors

- Extremely high adoption (510M+ downloads) ensures rapid issue discovery
- Active maintainer team with security expertise
- Strong relationship with Rust security team
- Comprehensive test suite and fuzzing
- Part of the core Rust async ecosystem

## Approval Status

- [x] APPROVED for use

**Conditions**: Use version >= 1.49.0 to ensure all security patches are
included.

---

## References

- [Crates.io](https://crates.io/crates/tokio)
- [GitHub Repository](https://github.com/tokio-rs/tokio)
- [RustSec Advisory Database](https://rustsec.org/packages/tokio.html)
- [RUSTSEC-2025-0023](https://rustsec.org/advisories/RUSTSEC-2025-0023.html)
- [RUSTSEC-2023-0005](https://rustsec.org/advisories/RUSTSEC-2023-0005.html)
- [RUSTSEC-2023-0001](https://rustsec.org/advisories/RUSTSEC-2023-0001.html)
- [RUSTSEC-2021-0124](https://rustsec.org/advisories/RUSTSEC-2021-0124.html)
