# Security Audit: hmac v0.12.1

## Crate Information

| Field | Value |
|-------|-------|
| **Crate** | [hmac](https://crates.io/crates/hmac) |
| **Version** | 0.12.1 (stable) |
| **Repository** | https://github.com/RustCrypto/MACs |
| **Documentation** | https://docs.rs/hmac |
| **License** | MIT OR Apache-2.0 |
| **Maintainer** | Tony Arcieri (@tarcieri), RustCrypto team |
| **Downloads** | 305M+ total |
| **Categories** | Cryptography, No standard library |

## Description

Generic implementation of Hash-based Message Authentication Code (HMAC). Part
of the RustCrypto project, providing pure Rust cryptographic implementations.

## RustSec Advisories

**No advisories found for `hmac` crate.**

The RustSec Advisory Database contains no security advisories directly against
the `hmac` crate as of 2026-02-01.

### Related Advisory (Different Crate)

- [RUSTSEC-2019-0019](https://rustsec.org/advisories/RUSTSEC-2019-0019.html):
  Affected the `blake2` crate (not `hmac`) - HMAC-BLAKE2 algorithms computed
  incorrect results due to wrong block sizes. Fixed in blake2 v0.8.1.

## Security Analysis

### Strengths

1. **Pure Rust Implementation**: No unsafe code dependencies, no C bindings
2. **Constant-Time Comparison**: Uses `CtOutput` for timing-attack resistant
   verification
3. **Active Maintenance**: Regular updates from established RustCrypto team
4. **Dual License**: MIT/Apache-2.0 permissive licensing
5. **Minimal Dependencies**: Only depends on `digest` crate from same project
6. **Well-Documented API**: Clear usage patterns and security warnings

### Security Considerations

1. **No Formal Audit**: No public third-party security audit has been performed
   specifically on this crate
2. **Timing Attacks**: Documentation warns about incorrect use of code values
   potentially enabling timing attacks
3. **Block Size Edge Cases**: Implementation handles edge cases where block
   size may not exceed output size

### Implementation Variants

| Type | Reset Support | Compatibility | Notes |
|------|---------------|---------------|-------|
| `Hmac` | No | Block-level API | Most efficient |
| `HmacReset` | Yes | Block-level API | Supports state reset |
| `SimpleHmac` | No | All Digest impls | Universal compatibility |
| `SimpleHmacReset` | Yes | All Digest impls | Most flexible |

## Dependencies

### Runtime

- `digest ^0.10.3` (RustCrypto)

### Development Only

- `sha2`, `sha-1`, `md-5`, `streebog` (testing)
- `hex-literal` (testing)

## Security Policy

The RustCrypto project maintains a [SECURITY.md](https://github.com/RustCrypto/MACs/blob/master/SECURITY.md)
with the following practices:

- Security updates applied to most recent release only
- Private vulnerability reporting via GitHub Security Advisories
- 90-day disclosure window requested
- Coordinated disclosure approach

## Recommendation

**APPROVED FOR USE**

The `hmac` crate is a well-maintained, pure Rust implementation from the
trusted RustCrypto organization. While no formal audit exists, the crate:

- Has no known vulnerabilities
- Is widely used (305M+ downloads)
- Is actively maintained by experienced cryptographers
- Uses constant-time comparison for security-critical operations
- Has minimal, auditable dependencies

### Usage Guidelines

1. Always use `verify_slice()` for MAC verification (timing-safe)
2. Never compare MAC values directly with `==`
3. Use `Hmac` or `HmacReset` for SHA-2 family hashes (more efficient)
4. Use `SimpleHmac` variants for BLAKE2 and other non-eager hashes
5. Keep the crate updated to receive security fixes

## Audit Metadata

| Field | Value |
|-------|-------|
| **Audit Date** | 2026-02-01 |
| **Audited Version** | 0.12.1 |
| **Latest Stable** | 0.12.1 |
| **Latest RC** | 0.13.0-rc.4 |
| **RustSec Check** | Passed (no advisories) |
