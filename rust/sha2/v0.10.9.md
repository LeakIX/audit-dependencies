# Security Audit: sha2 v0.10.9

## Crate Information

| Field | Value |
|-------|-------|
| **Crate** | [sha2](https://crates.io/crates/sha2) |
| **Version** | 0.10.9 |
| **Release Date** | 2025-04-30 |
| **License** | MIT OR Apache-2.0 |
| **Repository** | https://github.com/RustCrypto/hashes |
| **Documentation** | https://docs.rs/sha2 |
| **Downloads** | 90,277,240+ |
| **MSRV** | 1.85 |

## Description

Pure Rust implementation of the SHA-2 hash function family including SHA-224,
SHA-256, SHA-384, and SHA-512.

## Maintainers

| Name | GitHub | Role |
|------|--------|------|
| Artyom Pavlov | [@newpavlov](https://github.com/newpavlov) | Primary maintainer, publisher of v0.10.x |
| Tony Arcieri | [@tarcieri](https://github.com/tarcieri) | Publisher of v0.11.x pre-releases |

## Security Assessment

### Algorithm Security Status

SHA-2 is rated with **no known successful attacks** by the RustCrypto project.
It remains recommended for new applications where compatibility with existing
standards is not a primary concern.

### RustSec Advisories

#### RUSTSEC-2021-0100 (CVE-2021-45696)

| Field | Value |
|-------|-------|
| **Advisory ID** | [RUSTSEC-2021-0100](https://rustsec.org/advisories/RUSTSEC-2021-0100.html) |
| **CVE** | CVE-2021-45696 |
| **GHSA** | GHSA-fc7x-2cmc-8j2g, GHSA-xpww-g9jx-hp8r |
| **Severity** | Critical (CVSS 9.8/10) |
| **Affected Versions** | 0.9.7 only |
| **Patched Versions** | 0.9.8+ |
| **Status** | v0.9.7 yanked from crates.io |

**Description**: The v0.9.7 release introduced an AVX2-accelerated backend that
was automatically enabled for all x86/x86_64 CPUs where AVX2 support was
autodetected at runtime. The backend contained a bug that caused miscomputed
results for long messages (messages spanning multiple SHA blocks).

**CVSS v3 Metrics**:

- Attack Vector: Network
- Attack Complexity: Low
- Privileges Required: None
- User Interaction: None
- Confidentiality Impact: High
- Integrity Impact: High
- Availability Impact: High

**CWE**: CWE-327 (Use of a Broken or Risky Cryptographic Algorithm)

**Impact**: Any hashes computed using v0.9.7 for messages longer than a single
SHA block are incorrect and must be recomputed.

**Resolution**: Upgrade to v0.9.8 or later. Version 0.10.9 is not affected.

### Current Version Status (v0.10.9)

**v0.10.9 is NOT affected by any known vulnerabilities.**

The only RustSec advisory (RUSTSEC-2021-0100) specifically affected v0.9.7 only
and was patched in v0.9.8. The current v0.10.x series does not contain this bug.

## Dependencies

- `digest` - Core digest traits from RustCrypto
- Optional: `sha2-asm` - Assembly acceleration

## Features

| Feature | Description |
|---------|-------------|
| `default` | Standard configuration |
| `std` | Standard library support |
| `asm` | Assembly backends (x86/x86_64) |
| `asm-aarch64` | Assembly backend for ARM64 |
| `compress` | Expose compression functions |
| `force-soft` | Force software implementation |
| `force-soft-compact` | Force compact software implementation |
| `loongarch64_asm` | LoongArch64 assembly support |
| `oid` | OID support for algorithm identification |

## Recommendations

1. **APPROVED** for use - v0.10.9 has no known vulnerabilities
2. Ensure not using yanked v0.9.7 in any legacy projects
3. Consider enabling hardware acceleration features for performance:
   - `asm` for x86/x86_64
   - `asm-aarch64` for ARM64
4. Run `cargo audit` regularly to check for new advisories

## Audit Metadata

| Field | Value |
|-------|-------|
| **Audit Date** | 2026-02-01 |
| **Auditor** | Automated security review |
| **Sources** | crates.io, RustSec, GitHub Advisory Database |
