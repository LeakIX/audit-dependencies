# Security Audit: x25519-dalek v2.0.1

**Crate:** x25519-dalek
**Version:** 2.0.1 (current stable)
**Audit Date:** 2026-02-01
**License:** BSD-3-Clause

## Overview

X25519 elliptic curve Diffie-Hellman key exchange implementation in pure Rust,
using curve25519-dalek as the underlying elliptic curve library.

- **Repository:** https://github.com/dalek-cryptography/curve25519-dalek/tree/main/x25519-dalek
- **Documentation:** https://docs.rs/x25519-dalek
- **Crates.io:** https://crates.io/crates/x25519-dalek

## Direct RustSec Advisories

**None.** No RustSec advisories have been published directly against x25519-dalek.

## Transitive Dependency Vulnerabilities

### RUSTSEC-2024-0344: Timing variability in curve25519-dalek

| Field | Value |
|-------|-------|
| Advisory ID | RUSTSEC-2024-0344 |
| CVE | CVE-2024-58262 |
| GHSA | GHSA-x4gp-pqpj-f43q |
| Affected Package | curve25519-dalek |
| Affected Versions | < 4.1.3 |
| Patched Versions | >= 4.1.3 |
| Severity | Crypto Failure (timing side-channel) |
| Reported | June 18, 2024 |

**Description:**

The `Scalar29::sub` (32-bit) and `Scalar52::sub` (64-bit) functions in
curve25519-dalek contained timing variability. The LLVM compiler inserted
conditional branch instructions (`jns` on x86) that execute differently
depending on mask values, creating measurable timing differences when
processing secret scalar values.

Timing variability of any kind is problematic when working with potentially
secret values such as elliptic curve scalars, and such issues can potentially
leak private keys and other secrets.

**Impact on x25519-dalek:**

x25519-dalek v2.0.1 depends on curve25519-dalek ^4. If using curve25519-dalek
< 4.1.3, the timing vulnerability affects X25519 key exchange operations and
could potentially leak the ephemeral or static secret keys.

**Mitigation:**

Ensure curve25519-dalek is updated to >= 4.1.3. The fix introduces a volatile
read as an optimization barrier to prevent LLVM from inserting
data-dependent branches.

**References:**

- https://rustsec.org/advisories/RUSTSEC-2024-0344.html
- https://github.com/dalek-cryptography/curve25519-dalek/pull/659

## Third-Party Security Audits

### Quarkslab Audit (June 2019)

Quarkslab conducted a cryptographic security assessment of the dalek libraries
over approximately 30 days with two engineers. The audit covered subtle,
curve25519-dalek, bulletproofs, with a secondary review of x25519-dalek and
ed25519-dalek.

**Findings for x25519-dalek:** No vulnerabilities identified.

**Overall Findings (3 minor issues, no critical):**

1. **Scalar52 Overflow** - Overflow in `from_bits` method when importing a
   Scalar in curve25519-dalek
2. **Bulletproofs Dealer Crash** - Malicious party can trigger crash via
   crafted serialized message
3. **Memory Allocation via rmp-serde** - Third-party vulnerability allowing
   excessive memory allocation

**Recommendations:**

- Implement periodic regression testing for constant-time properties across
  Rust compiler versions
- Transition to stable Rust compiler when required features stabilize
- Acknowledge side-channel mitigations operate on best-effort basis

**References:**

- https://blog.quarkslab.com/security-audit-of-dalek-libraries.html
- https://blog.quarkslab.com/resources/2019-08-26-audit-dalek-libraries/19-06-594-REP.pdf

## Dependencies

| Dependency | Version | Purpose |
|------------|---------|---------|
| curve25519-dalek | ^4 | Underlying elliptic curve operations |
| rand_core | ^0.6 | Random number generation |
| serde | optional | Serialization support |
| zeroize | optional | Secure memory wiping |

## Security Features

- **Type-safe API:** Ephemeral secrets are consumed after use, preventing
  accidental key reuse
- **RFC 7748 compliance:** Implementation matches test vectors
- **Side-channel resistance:** Best-effort attempt to prevent software
  side-channels (subject to compiler/hardware behavior)
- **no_std support:** Works in constrained environments

## Risk Assessment

| Category | Risk Level | Notes |
|----------|------------|-------|
| Direct Vulnerabilities | Low | No advisories against x25519-dalek |
| Transitive Vulnerabilities | Medium | RUSTSEC-2024-0344 in curve25519-dalek |
| Maintenance Status | Active | Regular pre-release updates toward v3.0 |
| Audit Status | Audited | Quarkslab 2019, no critical findings |

## Recommendations

1. **Update curve25519-dalek** to >= 4.1.3 to address RUSTSEC-2024-0344
2. **Pin dependencies** in Cargo.lock and audit regularly with `cargo audit`
3. **Monitor for v3.0 stable release** - currently at 3.0.0-pre.5
4. **Consider threat model** - timing attacks require local access or network
   timing measurement capability

## Version History

| Version | Date | Notes |
|---------|------|-------|
| 2.0.1 | Feb 7, 2024 | Current stable |
| 2.0.0 | Aug 12, 2023 | Major release |
| 3.0.0-pre.5 | Jan 25, 2026 | Latest pre-release |

## Approval Status

**APPROVED** for use with the following conditions:

- Ensure curve25519-dalek >= 4.1.3 is in dependency tree
- Run `cargo audit` in CI pipeline
- Monitor RustSec for new advisories
