# Security Audit: chacha20poly1305 v0.10.1

## Crate Information

| Field | Value |
|-------|-------|
| **Crate** | [chacha20poly1305](https://crates.io/crates/chacha20poly1305) |
| **Version** | 0.10.1 (stable) |
| **Release Date** | 2022-08-10 |
| **Repository** | https://github.com/RustCrypto/AEADs |
| **Documentation** | https://docs.rs/chacha20poly1305 |
| **License** | Apache-2.0 OR MIT |
| **Maintainer** | Tony Arcieri (tarcieri) |
| **Downloads** | 42.6 million total |

## Description

Pure Rust implementation of the ChaCha20Poly1305 Authenticated Encryption with
Associated Data (AEAD) cipher as specified in RFC 8439. Provides:

- ChaCha20Poly1305 (RFC 8439)
- XChaCha20Poly1305 (extended 192-bit nonce variant)
- ChaCha8Poly1305 / ChaCha12Poly1305 (reduced-round variants)
- Optional hardware acceleration (AVX2 on x86/x86_64)
- no-std compatible

## Security Audit Status

### Professional Audit: PASSED

**Auditor**: NCC Group (Cryptography Services)
**Date**: December 2019 / February 2020
**Funded by**: MobileCoin
**Scope**: RustCrypto AES/GCM and ChaCha20+Poly1305 implementations
**Effort**: 5 person-days (2 consultants)

**Findings**: No vulnerabilities found.

The audit verified:

- Constant-time implementations to prevent timing attacks
- Proper use of constant-time comparison for authentication tags
- Suitable for SGX enclave contexts
- Only cosmetic remarks related to potential performance improvements

**Report**: [NCC Group Public Report](https://research.nccgroup.com/2020/02/26/public-report-rustcrypto-aes-gcm-and-chacha20poly1305-implementation-review/)

## RustSec Advisories

### Direct Advisories: NONE

No RustSec advisories exist for the `chacha20poly1305` crate itself.

### Related Advisory: RUSTSEC-2019-0029 (chacha20 crate)

| Field | Value |
|-------|-------|
| **Advisory** | RUSTSEC-2019-0029 |
| **CVE** | CVE-2019-25005 |
| **Affected Crate** | `chacha20` (dependency) |
| **Affected Versions** | < 0.2.3 |
| **CVSS v3** | 7.5 (HIGH) |
| **Vector** | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N |

**Description**: ChaCha20 counter overflow can expose repetitions in the
keystream. The ChaCha20 stream cipher can produce a maximum of 2^32 blocks
(~256GB) before the 32-bit counter overflows. Versions prior to 0.2.3 allowed
generating keystreams larger than this limit.

**Impact on chacha20poly1305**: **NOT AFFECTED**

The `chacha20poly1305` crate properly asserts plaintext length is less than
`P_MAX` as described in RFC 8439 Section 2.8, preventing this vulnerability
from being exploitable.

## Security Considerations

### Platform Limitations

**WARNING**: This cipher is not suitable for processors with variable-time
multiplication operations, including:

- Certain 32-bit PowerPC CPUs
- Some non-ARM microcontrollers

### Cryptographic Requirements

1. **Key Generation**: 256-bit (32-byte) keys must be generated using a
   cryptographically secure random number generator

2. **Nonce Uniqueness**: Each nonce MUST be unique per key
   - ChaCha20Poly1305: 96-bit (12-byte) nonce
   - XChaCha20Poly1305: 192-bit (24-byte) nonce for extended nonce scenarios

3. **Nonce Reuse**: Reusing a nonce with the same key completely breaks the
   security guarantees (confidentiality and authenticity)

4. **Maximum Message Size**: Limited by RFC 8439 specifications (~256GB)

### Recommended Variant

Use **ChaCha20Poly1305** (standard) or **XChaCha20Poly1305** (extended nonce).
Reduced-round variants (ChaCha8/ChaCha12) should only be used when explicitly
documented use cases from the "Too Much Crypto" paper apply.

## Dependency Chain

```
chacha20poly1305
├── aead (trait definitions)
├── chacha20 (stream cipher)
├── poly1305 (MAC)
└── cipher (trait definitions)
```

All dependencies are from the RustCrypto project and follow the same security
practices.

## Version History (Recent)

| Version | Date | Notes |
|---------|------|-------|
| 0.11.0-rc.2 | 2025-11-05 | Release candidate |
| 0.11.0-rc.1 | 2025-09-03 | Release candidate |
| 0.10.1 | 2022-08-10 | **Current stable** |
| 0.10.0 | 2022-08-01 | Major version |
| 0.9.1 | 2022-07-07 | Maintenance |

## Verdict

**APPROVED** for production use.

- No known vulnerabilities in the crate itself
- Professional security audit passed with no findings
- Active maintenance by reputable RustCrypto team
- Proper implementation of RFC 8439
- Constant-time operations to prevent timing attacks
- Wide adoption (42.6M downloads)

### Recommendations

1. Use version 0.10.1 or later
2. Always use cryptographically secure nonce generation
3. Consider XChaCha20Poly1305 for random nonce generation scenarios
4. Verify target platform has constant-time multiplication
5. Keep updated with RustCrypto security announcements

## References

- [RFC 8439 - ChaCha20 and Poly1305 for IETF Protocols](https://tools.ietf.org/html/rfc8439)
- [NCC Group Audit Report](https://research.nccgroup.com/2020/02/26/public-report-rustcrypto-aes-gcm-and-chacha20poly1305-implementation-review/)
- [RustCrypto AEADs Repository](https://github.com/RustCrypto/AEADs)
- [RUSTSEC-2019-0029](https://rustsec.org/advisories/RUSTSEC-2019-0029.html)
- [CVE-2019-25005](https://cvedetails.com/cve/CVE-2019-25005/)

---

**Audit Date**: 2026-02-01
**Audited By**: Security Review Process
