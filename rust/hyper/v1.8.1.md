# Security Audit: hyper v1.8.1

| Field | Value |
|-------|-------|
| Crate | [hyper](https://crates.io/crates/hyper) |
| Version | 1.8.1 |
| Repository | https://github.com/hyperium/hyper |
| Documentation | https://docs.rs/hyper |
| License | MIT |
| Audit Date | 2026-02-01 |

## Overview

hyper is a protective and efficient HTTP library for Rust, providing both client
and server implementations for HTTP/1 and HTTP/2. It is one of the most widely
used HTTP libraries in the Rust ecosystem with nearly 500 million total
downloads.

- **Maintainer**: Sean McArthur (seanmonstar)
- **Total Downloads**: ~500M
- **Recent Downloads**: ~77M
- **Lines of Code**: ~14,900
- **Minimum Rust Version**: 1.63

## Security Assessment

**Risk Level: MEDIUM** (when using version 1.x)

hyper has a significant history of security vulnerabilities, particularly
related to HTTP request smuggling and header parsing. However, the maintainer
has been responsive in addressing issues, and **version 1.8.1 is not affected by
any known vulnerabilities**.

### Key Security Considerations

1. **HTTP Request Smuggling** - Multiple historical vulnerabilities related to
   request smuggling. Ensure you are using patched versions.
2. **Header Parsing** - The library has had issues with lenient parsing that
   could be exploited in proxy scenarios.
3. **HTTP/2 Dependencies** - When using HTTP/2, be aware of vulnerabilities in
   the `h2` crate dependency.

## Historical Vulnerabilities

### RUSTSEC-2020-0008 (CVE-2020-35863) - CRITICAL

| Field | Value |
|-------|-------|
| Severity | CVSS 9.8 CRITICAL |
| Type | Request Smuggling |
| Affected | >= 0.11.0, < 0.12.34 |
| Patched | >= 0.12.34 |
| v1.8.1 Status | **Not Affected** |

**Description**: GET requests could include message bodies despite lacking
Transfer-Encoding or Content-Length headers. Per HTTP/1.1 specifications, such
requests should not have bodies, causing the body content to be interpreted as a
subsequent HTTP request. An attacker controlling request body and method could
inject requests with restricted headers, potentially bypassing CORS protections
or achieving remote code execution.

### RUSTSEC-2021-0079 (CVE-2021-32714) - CRITICAL

| Field | Value |
|-------|-------|
| Severity | CVSS 9.1 CRITICAL |
| Type | Integer Overflow |
| Affected | < 0.14.10 |
| Patched | >= 0.14.10 |
| v1.8.1 Status | **Not Affected** |

**Description**: Integer overflow vulnerability when processing chunk size
values that exceeded reasonable limits during Transfer-Encoding header decoding.
This could result in incorrect payload size calculations leading to data
corruption, or HTTP request smuggling attacks.

### RUSTSEC-2021-0020 (CVE-2021-21299) - HIGH

| Field | Value |
|-------|-------|
| Severity | CVSS 8.1 HIGH |
| Type | Request Smuggling |
| Affected | >= 0.12.0, < 0.12.36; >= 0.13.0, < 0.13.10; >= 0.14.0, < 0.14.3 |
| Patched | >= 0.12.36, >= 0.13.10, >= 0.14.3 |
| v1.8.1 Status | **Not Affected** |

**Description**: Requests containing multiple Transfer-Encoding headers were
incorrectly processed as having chunked payloads when they should have been
rejected. This misinterpretation could enable request smuggling attacks when
paired with upstream proxies that parse payload boundaries differently.

### RUSTSEC-2021-0078 (CVE-2021-32715) - MEDIUM

| Field | Value |
|-------|-------|
| Severity | CVSS 5.3 MEDIUM |
| Type | Request Smuggling |
| Affected | < 0.14.10 |
| Patched | >= 0.14.10 |
| v1.8.1 Status | **Not Affected** |

**Description**: The HTTP header parser was excessively permissive when
processing Content-Length headers, accepting values beginning with a plus sign
that violate RFC 7230 standards. This leniency could enable request smuggling
attacks when hyper operates behind an upstream proxy.

### RUSTSEC-2017-0002 (CVE-2017-18587) - MEDIUM

| Field | Value |
|-------|-------|
| Severity | CVSS 5.3 MEDIUM |
| Type | Header Injection |
| Affected | < 0.9.18; >= 0.10.0, < 0.10.2 |
| Patched | >= 0.9.18, >= 0.10.2 |
| v1.8.1 Status | **Not Affected** |

**Description**: The library failed to sanitize newline characters in HTTP
header values during serialization. This permitted attackers to inject carriage
returns or line feeds that could split a request or response, affecting
applications that construct headers from untrusted user input.

### RUSTSEC-2016-0002 (CVE-2016-10932) - MEDIUM

| Field | Value |
|-------|-------|
| Severity | CVSS 4.8 MEDIUM |
| Type | Cryptographic Failure |
| Affected | < 0.9.4 (Windows only) |
| Patched | >= 0.9.4 |
| v1.8.1 Status | **Not Affected** |

**Description**: On Windows platforms, hyper failed to verify hostnames when
establishing HTTPS connections. This enabled man-in-the-middle attacks using
certificates with hostname mismatches.

### RUSTSEC-2022-0022 - INFO (Unsoundness)

| Field | Value |
|-------|-------|
| Severity | INFO |
| Type | Memory Safety |
| Affected | < 0.14.12 |
| Patched | >= 0.14.12 |
| v1.8.1 Status | **Not Affected** |

**Description**: The HTTP/1 parser used `mem::uninitialized()` to instantiate
`httparse::Header` values, which is unsafe because this type contains
references requiring proper initialization. Uninitialized references can create
null-pointer conditions, leading to undefined behavior.

## Related Dependency Advisories

When using hyper with HTTP/2, be aware of vulnerabilities in the `h2` crate:

### RUSTSEC-2024-0003 - h2 Resource Exhaustion

**Description**: Resource exhaustion vulnerability in h2 may lead to Denial of
Service (DoS).

### RUSTSEC-2024-0332 - h2 CONTINUATION Flood

**Description**: Degradation of service in h2 servers with CONTINUATION Flood
attack.

## Recommendations

1. **Use Version 1.x** - The 1.x branch has addressed all known vulnerabilities.
   Version 1.8.1 is currently safe.

2. **Keep Updated** - hyper has a history of security issues. Monitor for new
   advisories regularly.

3. **Proxy Configurations** - Many vulnerabilities are exploitable when hyper
   operates behind proxies. Ensure consistent HTTP parsing between hyper and
   upstream proxies.

4. **Input Validation** - Never construct headers from untrusted user input
   without proper validation.

5. **Monitor h2 Crate** - If using HTTP/2 features, track security updates for
   the h2 dependency.

6. **Run cargo audit** - Regularly run `cargo audit` to check for known
   vulnerabilities in dependencies.

## Audit Result

| Check | Status |
|-------|--------|
| Known Vulnerabilities (v1.8.1) | PASS |
| Active Maintenance | PASS |
| Security Response History | PASS |
| Dependency Security (check h2) | WARN |

**Verdict**: hyper v1.8.1 is **APPROVED** for use. No known vulnerabilities
affect this version. However, given the library's security history, maintain
vigilance and keep the dependency updated.

## References

- [RustSec Advisory Database - hyper](https://rustsec.org/packages/hyper.html)
- [GitHub Security Advisories](https://github.com/hyperium/hyper/security/advisories)
- [hyper Documentation](https://docs.rs/hyper)
- [hyper GitHub Repository](https://github.com/hyperium/hyper)
