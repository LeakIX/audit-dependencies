# Security Audit: rand v0.9.2

## Crate Information

| Field | Value |
|-------|-------|
| Name | rand |
| Version | 0.9.2 |
| Latest | 0.9.2 (stable), 0.10.0-rc.8 (pre-release) |
| Description | Random number generators and other randomness functionality |
| Repository | https://github.com/rust-random/rand |
| Documentation | https://docs.rs/rand |
| Homepage | https://rust-random.github.io/book |
| License | MIT OR Apache-2.0 |
| Maintainer | Diggory Hardy (@dhardy) |
| Downloads | 860,852,730 total |
| Created | 2015-02-03 |
| Categories | algorithms, no-std |

## Security Assessment

### Overall Risk: LOW

The `rand` crate is one of the most widely used and thoroughly audited crates in
the Rust ecosystem. It provides both cryptographically secure (CSPRNG) and
non-cryptographic random number generation.

### Security Model

The rand project provides explicit security guarantees through marker traits:

- **CryptoRng** / **TryCryptoRng** / **CryptoBlockRng**: Markers for generators
  meeting cryptographic security requirements
- **SysRng**: Stateless implementation via `getrandom` - no state to leak
- **StdRng**: CSPRNG using ChaCha12 algorithm, selected for security and
  performance
- **ThreadRng**: Convenience wrapper with automatic seeding and periodic
  reseeding

### Security Disclaimer

From the official SECURITY.md:

> "Rand is a community project and cannot provide legally-binding guarantees of
> security."

## Known Vulnerabilities

### RUSTSEC-2021-0023 (rand_core) - CRITICAL

| Field | Value |
|-------|-------|
| Advisory | RUSTSEC-2021-0023 |
| CVE | CVE-2021-27378 |
| GHSA | GHSA-w7j2-35mf-95p7 |
| CVSS | 9.8 (Critical) |
| Package | rand_core |
| Affected | >= 0.6.0, < 0.6.2 |
| Patched | >= 0.6.2 |
| Date | 2021-02-12 |

**Description**: Incorrect buffer length validation in `rand_core::le::read_u32_into`
and `rand_core::le::read_u64_into` allowed destination buffers to be under-filled.
This enabled some downstream RNGs (notably Hc128Rng, but NOT ChaCha*Rng) to accept
insufficiently short seed values via `SeedableRng::from_seed`.

**Impact**: Compromised cryptographic guarantees for vulnerable RNGs when seeded
with short keys.

**Status**: FIXED in rand_core 0.6.2+. Current rand 0.9.2 uses patched version.

### GHSA-mmc9-pwm7-qj5w (rand_core) - LOW

| Field | Value |
|-------|-------|
| Advisory | GHSA-mmc9-pwm7-qj5w |
| CVE | None |
| Severity | Low |
| Package | rand_core |
| Affected | < 0.4.2 |
| Patched | >= 0.4.2 |
| Date | 2020-08-01 |

**Description**: Unaligned memory access when casting byte slices to integer
slices in `BlockRng::next_u64` and `BlockRng::fill_bytes`, resulting in
undefined behavior.

**Status**: FIXED in rand_core 0.4.2+. Current rand 0.9.2 uses patched version.

## RNG Predictability Analysis

### Cryptographically Secure RNGs (CSPRNGs)

The following generators implement `CryptoRng` and are suitable for
security-sensitive applications:

| Generator | Algorithm | Notes |
|-----------|-----------|-------|
| StdRng | ChaCha12 | Default CSPRNG, may change between releases |
| ChaCha12Rng | ChaCha12 | Reproducible, 12 rounds |
| ChaCha20Rng | ChaCha20 | Reproducible, 20 rounds (more conservative) |
| ThreadRng | ChaCha12 | Auto-seeded, periodic reseeding |
| SysRng | OS/getrandom | Stateless, uses OS entropy |

### Non-Cryptographic RNGs (NOT secure)

These generators are fast but predictable - DO NOT use for security:

| Generator | Notes |
|-----------|-------|
| SmallRng | Fast, not reproducible, NOT secure |
| Xoshiro256Plus | Predictable with sufficient output |
| PCG family | Easier to predict than CSPRNGs |

### Predictability Concerns

Regular PRNGs are predictable with varying difficulty:

- **Xorshift**: Trivially predictable - outputs part of state without mutation
- **PCG / Truncated Xorshift***: Harder but still feasible with common
  mathematics and desktop computing power

**Recommendation**: Always use `CryptoRng`-implementing generators for any
security-sensitive randomness (keys, tokens, nonces, etc.).

## Dependency Chain

```
rand 0.9.2
├── rand_core 0.9.x (patched)
├── rand_chacha 0.9.x (ChaCha implementation)
└── getrandom (OS entropy source)
```

## Recommendations

1. **Use CryptoRng generators** for all security-sensitive operations
2. **Prefer StdRng or ThreadRng** for general cryptographic use
3. **Use ChaCha20Rng** when reproducibility is needed with maximum security
4. **Never use SmallRng** or non-CryptoRng generators for security
5. **Ensure rand_core >= 0.6.2** to avoid CVE-2021-27378

## Audit Checklist

- [x] No unpatched CVEs in current version
- [x] CSPRNG implementation uses well-analyzed algorithm (ChaCha)
- [x] Clear separation between secure and non-secure RNGs via traits
- [x] Active maintenance with security policy
- [x] 90-day coordinated disclosure process
- [x] Security fixes provided for 12 months of releases

## Conclusion

The `rand` crate v0.9.2 is **APPROVED** for use. All known vulnerabilities have
been patched in current versions. The crate provides clear security guarantees
through the `CryptoRng` trait system and uses the well-established ChaCha
algorithm for its default CSPRNG.

**Key guidance**: Always verify you're using `CryptoRng`-implementing generators
for security-sensitive randomness.

## References

- [RustSec RUSTSEC-2021-0023](https://rustsec.org/advisories/RUSTSEC-2021-0023.html)
- [GitHub Security Advisory GHSA-mmc9-pwm7-qj5w](https://github.com/rust-random/rand/security/advisories/GHSA-mmc9-pwm7-qj5w)
- [Rand Security Policy](https://github.com/rust-random/rand/blob/master/SECURITY.md)
- [The Rust Rand Book - Our RNGs](https://rust-random.github.io/book/guide-rngs.html)
- [CVE-2021-27378](https://nvd.nist.gov/vuln/detail/CVE-2021-27378)

---

*Audit performed: 2026-02-01*
