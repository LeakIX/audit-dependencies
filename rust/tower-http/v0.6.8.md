# Security Audit: tower-http v0.6.8

**Audit Date**: 2026-02-01
**Auditor**: Claude (AI-assisted)
**Risk Level**: LOW

## Summary

tower-http is a widely-used HTTP middleware library for Rust's Tower ecosystem
with over 185 million downloads. It provides HTTP-specific utilities including
compression, CORS, authentication, tracing, and file serving. The crate had one
significant security vulnerability (path traversal on Windows) which was patched
in January 2022. Version 0.6.8 is fully patched and safe to use.

## Package Identity

| Field        | Value                                      |
| ------------ | ------------------------------------------ |
| Registry     | https://crates.io/crates/tower-http        |
| Repository   | https://github.com/tower-rs/tower-http     |
| License      | MIT                                        |
| Maintainers  | Sean McArthur (seanmonstar), David Pedersen (davidpdrsn), Lucio Franco |
| Last Release | 2025-12-08 (v0.6.8)                        |
| Downloads    | 185,192,633 total / 41,680,616 recent      |
| Created      | 2021                                       |
| Versions     | 34 releases                                |
| Used By      | ~62,300 projects                           |

## Vulnerabilities

### Known CVEs

| CVE ID | RustSec ID        | Severity | Status  | Fixed In           |
| ------ | ----------------- | -------- | ------- | ------------------ |
| N/A    | RUSTSEC-2022-0043 | High     | PATCHED | >= 0.1.3, >= 0.2.1 |

### Security Advisories

#### RUSTSEC-2022-0043 - Windows Path Traversal in ServeDir

- **Type**: Path Traversal / File Disclosure
- **Affected**: < 0.1.3, 0.2.0
- **Patched**: >= 0.1.3, >= 0.2.1
- **Reported**: 2022-01-14
- **Fixed**: 2022-01-21
- **Description**: The `tower_http::services::fs::ServeDir` service failed to
  properly validate Windows filesystem paths. Attackers could construct requests
  like `/foo/bar/c:/windows/web/screen/img101.png` to access files from absolute
  Windows paths, bypassing directory restrictions. This allowed reading arbitrary
  files on the system.
- **Root Cause**: Rust's `PathBuf::push()` method handles drive letters like
  `c:` as normal path components rather than prefix components, allowing path
  escape from the serving directory.
- **Fix**: The patch validates all path components individually, rejecting any
  that contain non-normal elements (prefixes, parent directory references).
- **Impact**: HIGH on Windows deployments serving static files; NONE on
  Linux/Unix systems.
- **Status**: PATCHED in 0.6.8

## Supply Chain Analysis

- **Build Process**: Pure Rust crate, no build scripts with external downloads
- **Binary Artifacts**: None - source-only distribution
- **Reproducible Builds**: Yes - standard Cargo build process
- **Code Signing**: Crates.io cryptographic verification
- **Provenance**: tower-rs organization (same as Tower, trusted ecosystem)

## Dependency Tree

### Direct Dependencies (Runtime)

| Dependency     | Purpose                          |
| -------------- | -------------------------------- |
| tower          | Core service abstraction         |
| tower-layer    | Middleware layer trait           |
| tower-service  | Service trait                    |
| http           | HTTP types                       |
| http-body      | HTTP body abstraction            |
| http-body-util | Body utilities                   |
| bytes          | Byte buffer utilities            |
| pin-project-lite | Pin projection                 |

### Optional Dependencies (Feature-gated)

| Dependency        | Feature       | Purpose                    |
| ----------------- | ------------- | -------------------------- |
| tokio             | fs, timeout   | Async runtime              |
| tracing           | trace         | Request/response tracing   |
| async-compression | compression   | Compression middleware     |
| mime              | fs            | MIME type detection        |
| httpdate         | fs            | HTTP date parsing          |
| percent-encoding  | fs            | URL decoding               |
| base64            | auth          | Basic auth encoding        |

### Notable Observations

- Well-scoped dependencies aligned with tower ecosystem
- Heavy use of optional dependencies for minimal footprint
- All core dependencies are well-established, audited crates

## Maintenance Health

| Metric          | Status                         |
| --------------- | ------------------------------ |
| Last commit     | 2025-12-08                     |
| Last release    | 2025-12-08 (v0.6.8)            |
| Open issues     | 45                             |
| Stars           | 848                            |
| Forks           | 217                            |
| Contributors    | 90                             |
| Age             | 4+ years                       |
| CI/CD           | Yes (GitHub Actions)           |
| MSRV            | Rust 1.66                      |

## Security Considerations for HTTP Middleware

### Path Traversal (PATCHED)

The primary risk for file-serving middleware is path traversal attacks. This was
the subject of RUSTSEC-2022-0043 and has been thoroughly patched. The fix ensures
all path components are validated individually before serving files.

### Current Mitigations in Place

1. **Component-level path validation** - Each path segment is validated
2. **Prefix detection** - Drive letters and absolute paths are rejected
3. **Parent directory blocking** - `..` components are rejected

### Recommendations for Users

1. **Keep updated** - Use version >= 0.2.1 (current 0.6.8 is safe)
2. **Limit ServeDir scope** - Serve from minimal directories
3. **Review access patterns** - Log and monitor file access requests
4. **Defense in depth** - Use additional access controls at OS level

## Risk Factors

| Factor                    | Assessment |
| ------------------------- | ---------- |
| Maintenance abandonment   | Low        |
| Supply chain compromise   | Very Low   |
| Unpatched vulnerabilities | None       |
| Dependency risk           | Low        |
| Platform-specific issues  | Low        |

### Mitigating Factors

- Part of the widely-adopted tower ecosystem
- Active maintainer team (seanmonstar is also hyper maintainer)
- High adoption (185M+ downloads) ensures rapid issue discovery
- Quick response to security reports (7 days from report to fix)
- Yanked vulnerable versions from crates.io

## Approval Status

- [x] APPROVED for use

**Conditions**: Use version >= 0.6.8 to ensure all security patches are
included. If serving static files on Windows, verify you are using patched
version and review access logs.

---

## References

- [Crates.io](https://crates.io/crates/tower-http)
- [GitHub Repository](https://github.com/tower-rs/tower-http)
- [RustSec Advisory RUSTSEC-2022-0043](https://rustsec.org/advisories/RUSTSEC-2022-0043.html)
- [Fix PR #204](https://github.com/tower-rs/tower-http/pull/204)
- [Tower Project](https://github.com/tower-rs/tower)
