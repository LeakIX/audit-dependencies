# Security Audit: @docusaurus/preset-classic

- **Package**: @docusaurus/preset-classic
- **Version**: 3.9.2 (latest)
- **License**: MIT
- **Audit Date**: 2026-02-01

## Package Overview

Preset for classic Docusaurus - a bundled configuration package for the
Docusaurus static site generator framework.

### Maintainers

- joelmarcey (joelm@fb.com)
- yangshun (tay.yang.shun@gmail.com)
- endiliey (endiliey@gmail.com)
- lex111 (lex61rus@gmail.com)
- fb (opensource+npm@fb.com)

### Dependencies

- @docusaurus/theme-classic
- @docusaurus/plugin-sitemap
- @docusaurus/plugin-google-gtag
- @docusaurus/plugin-content-blog
- @docusaurus/plugin-content-docs
- @docusaurus/plugin-content-pages
- @docusaurus/theme-search-algolia
- @docusaurus/plugin-google-analytics

## Direct Vulnerabilities

**No direct vulnerabilities found** in Snyk's vulnerability database for
@docusaurus/preset-classic or @docusaurus/core.

## Dependency Vulnerabilities

### CVE-2025-30359: webpack-dev-server Source Code Theft

| Field            | Value                                      |
| ---------------- | ------------------------------------------ |
| CVE ID           | CVE-2025-30359                             |
| GHSA ID          | GHSA-4v9v-hfq4-rm2v                        |
| Severity         | Medium (5.3 CVSS v3.1)                     |
| Vector           | CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A |
| Affected Package | webpack-dev-server <= 5.2.0               |
| Fixed Version    | webpack-dev-server 5.2.1                   |
| CWE              | CWE-749 (Exposed Dangerous Method)         |

**Description**: webpack-dev-server users' source code may be stolen when they
access a malicious website. An attacker can inject a script tag pointing to
localhost (e.g., `http://localhost:8080/main.js`). Since classic script
requests bypass same-origin policy, the webpack runtime executes.

The attack exploits prototype pollution against `Array.prototype.forEach` to
extract references to `__webpack_require__`, then uses `Function.toString()` to
retrieve source code from `__webpack_modules__`.

**Requirements**: The attacker must know the port number and output entrypoint
script path.

**Status**: Reported in [GitHub Issue #11334][gh-11334] for Docusaurus 3.8.1.
Issue closed as duplicate pointing to discussion #11252. Backport for v4 was in
progress.

**Mitigation**:

1. Update webpack-dev-server to version 5.2.1 or later
2. Use non-standard ports for development servers
3. Avoid predictable output paths for entrypoint scripts
4. Never access untrusted websites while running dev servers locally

### Historical Nested Dependency Issues

Previous versions of Docusaurus have had issues reported with nested
dependencies including:

- webpack-dev-server@4.15.2 with express@4.19.2
- serve-handler@6.1.5

These are typically build-time dependencies that do not pose runtime threats in
production.

## Docusaurus Team Position

The official Docusaurus documentation notes that "npm install may report
several vulnerabilities and recommend running npm audit to address them.
Typically, these reported vulnerabilities, such as RegExp DOS vulnerabilities,
are harmless and can be safely ignored."

Many CVE-related issues are labeled by the Docusaurus team as
"please-fix-this-cve" with the note that the issue "is asking for fixing a CVE
in a build-only dep which doesn't pose any real threat."

## Risk Assessment

| Risk Category      | Level  | Notes                                        |
| ------------------ | ------ | -------------------------------------------- |
| Direct Vulns       | None   | No direct vulnerabilities                    |
| Dependency Vulns   | Medium | webpack-dev-server CVE-2025-30359            |
| Production Risk    | Low    | Vulnerabilities affect dev environment only  |
| Supply Chain       | Low    | Package maintained by Facebook/Meta          |
| Maintenance Status | Good   | Regular releases, active development         |

## Recommendations

1. **Safe for production use** - The identified vulnerabilities only affect the
   development environment, not production builds.

2. **Development precautions** - When running `docusaurus start`:
   - Avoid visiting untrusted websites
   - Use non-default ports
   - Keep webpack-dev-server updated when possible

3. **Monitor for updates** - Subscribe to Docusaurus releases for security
   patches.

4. **Audit overrides** - Consider using npm overrides to force
   webpack-dev-server >= 5.2.1 if concerned about dev environment security.

## References

- [npm: @docusaurus/preset-classic][npm]
- [Snyk: @docusaurus/core][snyk-core]
- [GitHub Advisory: GHSA-4v9v-hfq4-rm2v][ghsa]
- [NVD: CVE-2025-30359][nvd]
- [GitHub Issue #11334][gh-11334]

[npm]: https://www.npmjs.com/package/@docusaurus/preset-classic
[snyk-core]: https://security.snyk.io/package/npm/%40docusaurus%2Fcore
[ghsa]: https://github.com/advisories/GHSA-4v9v-hfq4-rm2v
[nvd]: https://nvd.nist.gov/vuln/detail/CVE-2025-30359
[gh-11334]: https://github.com/facebook/docusaurus/issues/11334
