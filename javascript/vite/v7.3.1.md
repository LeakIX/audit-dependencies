# Security Audit: vite v7.3.1

## Package Information

| Field | Value |
|-------|-------|
| Package | [vite](https://www.npmjs.com/package/vite) |
| Version | 7.3.1 |
| Description | Native-ESM powered web dev build tool |
| License | MIT |
| Author | Evan You |
| Repository | https://github.com/vitejs/vite |
| Homepage | https://vite.dev |

## Dependencies

| Dependency | Version |
|------------|---------|
| fdir | ^6.5.0 |
| rollup | ^4.43.0 |
| esbuild | ^0.27.0 |
| postcss | ^8.5.6 |
| picomatch | ^4.0.3 |
| tinyglobby | ^0.2.15 |

## Security Assessment

**Risk Level: HIGH**

Vite is a build tool with a development server that has had **numerous critical
and high-severity security vulnerabilities** throughout 2024-2025. Most
vulnerabilities relate to:

1. Path traversal and arbitrary file read attacks via the dev server
2. Bypass of `server.fs.deny` security restrictions
3. WebSocket/CORS origin validation issues
4. XSS vulnerabilities in HTML transformation

**Critical Warning**: Vite's development server should **NEVER be exposed to
untrusted networks**. Many vulnerabilities only affect applications that expose
the dev server via `--host` or `server.host`, but some (like CVE-2025-24010)
affect even local-only usage.

## Known Vulnerabilities

### CVE-2025-62522 - Windows File Access Bypass (October 2025)

| Field | Value |
|-------|-------|
| Severity | Medium (CVSS 6.0) |
| Type | Directory Traversal |
| Affected | 2.9.18 - 7.1.10 |
| Fixed | 5.4.21, 6.4.1, 7.0.8, 7.1.11 |

Files denied by `server.fs.deny` were served if the URL ended with `\` on
Windows. Attackers could access `.env` files and other sensitive data by
appending a backslash to the URL.

**Status**: v7.3.1 is **VULNERABLE** (requires 7.1.11+)

### CVE-2025-58752 - Dev Server Path Traversal (September 2025)

| Field | Value |
|-------|-------|
| Severity | Low (CVSS 2.3) |
| Type | Relative Path Traversal (CWE-23) |
| Affected | <5.4.20, 6.0.0-6.3.5, 7.0.0-7.0.6, 7.1.0-7.1.4 |
| Fixed | 5.4.20, 6.3.6, 7.0.7, 7.1.5 |

The `server.fs` security settings were not applied to HTML file requests. The
`indexHtmlMiddleware` function was vulnerable to path traversal, allowing
arbitrary HTML file access.

**Status**: v7.3.1 is **VULNERABLE** (requires 7.1.5+)

### CVE-2025-46565 - Directory Traversal (May 2025)

| Field | Value |
|-------|-------|
| Severity | Medium |
| Type | Directory Traversal (CWE-22) |
| Affected | <4.5.14, <5.4.19, <6.1.6, <6.2.7, <6.3.4 |
| Fixed | 4.5.14, 5.4.19, 6.1.6, 6.2.7, 6.3.4 |

Files under project root denied by `server.fs.deny` patterns could be bypassed
using `/. ` combinations, exposing `.env` files and certificates.

**Status**: v7.3.1 is **NOT AFFECTED** (fixed in 6.x line)

### CVE-2025-31486 - Arbitrary File Read via SVG/Relative Paths (April 2025)

| Field | Value |
|-------|-------|
| Severity | Medium (CVSS 5.3) |
| Type | Access Control Bypass |
| Affected | <4.5.12, <5.4.17, <6.0.14, <6.1.4, <6.2.5 |
| Fixed | 4.5.12, 5.4.17, 6.0.14, 6.1.4, 6.2.5 |

`server.fs.deny` could be bypassed using `.svg` extension with `?.wasm?init` or
relative path traversal (`../../`). Limited to files smaller than 4kB (default
`assetsInlineLimit`).

**Status**: v7.3.1 is **NOT AFFECTED**

### CVE-2025-31125 - Access Control Bypass (March 2025)

| Field | Value |
|-------|-------|
| Severity | Medium (CVSS 5.3) |
| Type | Access Control Bypass (CWE-200) |
| Affected | <4.5.11, <5.4.16, <6.0.13, <6.1.3, <6.2.4 |
| Fixed | 4.5.11, 5.4.16, 6.0.13, 6.1.3, 6.2.4 |

`server.fs.deny` bypassed using `?import` query with `inline` and `raw`
parameters. Base64 encoded content exposed via `?inline&import`, raw content
via `?raw?import`.

**CISA has confirmed active exploitation of this vulnerability.**

**Status**: v7.3.1 is **NOT AFFECTED**

### CVE-2025-30208 - Arbitrary File Read via @fs (March 2025)

| Field | Value |
|-------|-------|
| Severity | Medium (CVSS 5.3) |
| Type | Path Traversal |
| Affected | <4.5.10, <5.4.15, <6.0.12, <6.1.2, <6.2.3 |
| Fixed | 4.5.10, 5.4.15, 6.0.12, 6.1.2, 6.2.3 |

Adding `?raw??` or `?import&raw??` to URLs bypassed @fs restrictions, allowing
arbitrary file reads including `/etc/passwd`. PoC exploits publicly available.

**Status**: v7.3.1 is **NOT AFFECTED**

### CVE-2025-24010 - WebSocket/CORS Origin Validation (January 2025)

| Field | Value |
|-------|-------|
| Severity | Medium |
| Type | Origin Validation Error |
| Affected | <4.5.6, <5.4.12, <6.0.9 |
| Fixed | 4.5.6, 5.4.12, 6.0.9 |

Default CORS settings and lack of Origin header validation for WebSocket
connections allowed any website to send requests to the dev server and read
responses. **Affects even local-only servers.**

**Status**: v7.3.1 is **NOT AFFECTED**

### CVE-2024-45812 - DOM Clobbering XSS (September 2024)

| Field | Value |
|-------|-------|
| Severity | Medium (CVSS 6.4) |
| Type | Cross-site Scripting (CWE-79) |
| Affected | <3.2.11, <4.5.5, <5.2.14, <5.3.6, <5.4.6 |
| Fixed | 3.2.11, 4.5.5, 5.2.14, 5.3.6, 5.4.6 |

DOM Clobbering vulnerability when building scripts to cjs/iife/umd format.
Attackers could shadow `document.currentScript` to inject malicious scripts.

**Status**: v7.3.1 is **NOT AFFECTED**

### CVE-2024-45811 - Information Exposure (September 2024)

| Field | Value |
|-------|-------|
| Severity | Medium |
| Type | Information Exposure (CWE-200) |
| Affected | <3.2.11, <4.5.5, <5.2.14, <5.3.6, <5.4.6 |
| Fixed | 3.2.11, 4.5.5, 5.2.14, 5.3.6, 5.4.6 |

`?import&raw` URL parameters bypassed @fs restrictions, exposing arbitrary file
contents.

**Status**: v7.3.1 is **NOT AFFECTED**

### CVE-2024-31207 - Improper Access Control (April 2024)

| Field | Value |
|-------|-------|
| Severity | Medium |
| Type | Improper Access Control (CWE-284) |
| Affected | 2.7.0-2.9.17, 3.0.0-3.2.8, 4.0.0-4.5.2, 5.0.0-5.2.5 |
| Fixed | 2.9.18, 3.2.10, 4.5.3, 5.0.13, 5.1.7, 5.2.6 |

`server.fs.deny` failed to deny requests for patterns with directories. Custom
deny patterns like `['**/.git/**']` could be bypassed.

**Status**: v7.3.1 is **NOT AFFECTED**

### CVE-2023-49293 - XSS via transformIndexHtml (December 2023)

| Field | Value |
|-------|-------|
| Severity | Medium (CVSS 6.1) |
| Type | Cross-site Scripting (CWE-80) |
| Affected | <4.4.12, <4.5.1, <5.0.5 |
| Fixed | 4.4.12, 4.5.1, 5.0.5 |

When `server.transformIndexHtml` is invoked manually with inline module
scripts, malicious URL query strings could inject arbitrary HTML.

**Status**: v7.3.1 is **NOT AFFECTED**

## Current Status Summary

**Version 7.3.1 has known vulnerabilities:**

| CVE | Status | Action Required |
|-----|--------|-----------------|
| CVE-2025-62522 | VULNERABLE | Upgrade to 7.1.11+ |
| CVE-2025-58752 | VULNERABLE | Upgrade to 7.1.5+ |

## Recommendations

### Immediate Actions

1. **Upgrade to latest patched version** (7.1.11 or later) to address
   CVE-2025-62522 and CVE-2025-58752

2. **Never expose dev server to networks** - Do not use `--host` or
   `server.host` unless absolutely necessary

3. **Review server.fs.deny configuration** - Ensure sensitive files are
   properly denied

### Configuration Hardening

```javascript
// vite.config.js
export default {
  server: {
    // Never expose to network in development
    host: false,

    // Strict file system restrictions
    fs: {
      strict: true,
      deny: ['.env', '.env.*', '*.{crt,pem}', '.git/**'],
    },

    // Restrict CORS if backend integration is used
    cors: {
      origin: 'http://localhost:3000', // specific origin, not '*'
    },
  },
};
```

### Best Practices

1. Keep Vite updated to the latest patch version
2. Use firewall rules to restrict dev server access
3. Never run dev server in production
4. Monitor Vite security advisories at
   https://github.com/vitejs/vite/security/advisories

## References

- [Snyk Vite Vulnerabilities](https://security.snyk.io/package/npm/vite)
- [GitHub Security Advisories](https://github.com/vitejs/vite/security/advisories)
- [CVE-2025-62522 Advisory](https://github.com/advisories/GHSA-93m4-6634-74q7)
- [CVE-2025-58752 Advisory](https://github.com/advisories/GHSA-jqfw-vq24-v9c3)
- [CVE-2025-46565 Advisory](https://nvd.nist.gov/vuln/detail/CVE-2025-46565)
- [CVE-2025-31486 Advisory](https://github.com/advisories/GHSA-xcj6-pq6g-qj4x)
- [CVE-2025-31125 Advisory](https://security.snyk.io/vuln/SNYK-JS-VITE-9576207)
- [CVE-2025-30208 Analysis](https://www.offsec.com/blog/cve-2025-30208/)
- [CVE-2025-24010 Advisory](https://github.com/advisories/GHSA-vg6x-rcgg-rjx6)

## Audit Metadata

| Field | Value |
|-------|-------|
| Audit Date | 2026-02-01 |
| Audited Version | 7.3.1 |
| Latest Available | 7.3.1 |
| Recommendation | Upgrade to 7.1.11+ when available in 7.3.x line |
