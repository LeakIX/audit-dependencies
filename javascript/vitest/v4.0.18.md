# Security Audit: vitest v4.0.18

**Package:** vitest
**Version:** 4.0.18
**Audit Date:** 2026-02-01
**Category:** Test Runner

## Package Information

| Field | Value |
|-------|-------|
| Name | vitest |
| Version | 4.0.18 |
| License | MIT |
| Repository | https://github.com/vitest-dev/vitest |
| Author | Anthony Fu |
| Weekly Downloads | ~25M |

## Description

A blazing fast unit test framework powered by Vite. Vitest is a Vite-native
testing framework that provides a Jest-compatible API with first-class ESM
support, TypeScript support, and smart watch mode.

## Security Assessment

**Overall Status:** SECURE (in latest version)

The latest version 4.0.18 has no known vulnerabilities. All previously
identified security issues have been patched.

## Historical Vulnerabilities

### CVE-2025-24964: Remote Code Execution via WebSocket Hijacking

| Field | Value |
|-------|-------|
| CVE ID | CVE-2025-24964 |
| GHSA ID | GHSA-9crc-q9x8-hgqq |
| Severity | **CRITICAL** (9.7/10) |
| CWE | CWE-1385 (Missing Origin Validation in WebSockets) |
| Published | 2025-02-04 |

**Description:**

When the Vitest API server is listening (enabled by default when using Vitest
UI), the WebSocket server lacks proper origin header validation and
authorization mechanisms. This makes it vulnerable to Cross-site WebSocket
hijacking (CSWSH) attacks.

An attacker can:

1. Host a malicious webpage that connects to a victim's running Vitest server
2. Inject arbitrary code into test files via the `saveTestFile` API
3. Execute that code by triggering the `rerun` API
4. Achieve complete system compromise with full RCE

**Attack Vector:** Network (requires victim to visit malicious website while
Vitest is running)

**Affected Versions:**

- `<= 0.0.125`
- `>= 1.0.0, < 1.6.1`
- `>= 2.0.0, < 2.1.9`
- `>= 3.0.0, < 3.0.5`

**Patched Versions:**

- `>= 1.6.1, < 2.0.0`
- `>= 2.1.9, < 3.0.0`
- `>= 3.0.5`

**Workarounds:** None. Upgrade immediately.

**References:**

- https://github.com/vitest-dev/vitest/security/advisories/GHSA-9crc-q9x8-hgqq
- https://nvd.nist.gov/vuln/detail/CVE-2025-24964
- https://security.snyk.io/vuln/SNYK-JS-VITEST-8688130

---

### CVE-2025-24963: Directory Traversal in Browser Mode

| Field | Value |
|-------|-------|
| CVE ID | CVE-2025-24963 |
| GHSA ID | GHSA-8gvc-j273-4wm5 |
| Severity | **MODERATE** (5.9/10) |
| CWE | CWE-22 (Path Traversal) |
| Published | 2025-02-04 |

**Description:**

The `__screenshot-error` handler in Vitest's browser mode HTTP server responds
with arbitrary files from the file system without proper path validation. When
the server is explicitly exposed to the network using `browser.api.host: true`,
attackers can request any file.

**Exploitation:**

```bash
curl http://localhost:63315/__screenshot-error?file=/etc/passwd
```

**Conditions:**

- Requires `browser.api.host: true` configuration (not default)
- Server must be network-accessible

**Affected Versions:**

- `>= 2.0.4, < 2.1.9`
- `>= 3.0.0, < 3.0.4`

**Patched Versions:**

- `>= 2.1.9, < 3.0.0`
- `>= 3.0.4`

**Workarounds:** Do not set `browser.api.host: true` in configuration.

**References:**

- https://github.com/advisories/GHSA-8gvc-j273-4wm5
- https://nvd.nist.gov/vuln/detail/CVE-2025-24963
- https://security.snyk.io/vuln/SNYK-JS-VITEST-8688125

## Recommendations

1. **Use version 4.0.18 or later** - All known vulnerabilities are patched
2. **Keep updated** - Subscribe to GitHub security advisories for vitest-dev/vitest
3. **Avoid exposing dev servers** - Never expose Vitest API to public networks
4. **Review configuration** - Ensure `browser.api.host: true` is not set unless
   absolutely necessary

## Version Matrix

| Version Range | CVE-2025-24964 | CVE-2025-24963 | Status |
|---------------|----------------|----------------|--------|
| 4.x | Not affected | Not affected | Safe |
| 3.0.5+ | Not affected | Not affected | Safe |
| 3.0.0 - 3.0.4 | Vulnerable | Vulnerable | Upgrade |
| 2.1.9+ | Not affected | Not affected | Safe |
| 2.0.4 - 2.1.8 | Vulnerable | Vulnerable | Upgrade |
| 2.0.0 - 2.0.3 | Vulnerable | Not affected | Upgrade |
| 1.6.1+ | Not affected | Not affected | Safe |
| 1.0.0 - 1.6.0 | Vulnerable | Not affected | Upgrade |
| <= 0.0.125 | Vulnerable | Not affected | Upgrade |

## Sources

- [Snyk vitest vulnerabilities](https://security.snyk.io/package/npm/vitest)
- [GitHub Advisory GHSA-9crc-q9x8-hgqq](https://github.com/vitest-dev/vitest/security/advisories/GHSA-9crc-q9x8-hgqq)
- [GitHub Advisory GHSA-8gvc-j273-4wm5](https://github.com/advisories/GHSA-8gvc-j273-4wm5)
- [NVD CVE-2025-24964](https://nvd.nist.gov/vuln/detail/CVE-2025-24964)
- [NVD CVE-2025-24963](https://nvd.nist.gov/vuln/detail/CVE-2025-24963)
- [npm registry](https://registry.npmjs.org/vitest)
