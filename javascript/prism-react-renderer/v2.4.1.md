# Security Audit: prism-react-renderer v2.4.1

**Audit Date:** 2026-02-01
**Package:** prism-react-renderer
**Version:** 2.4.1
**License:** MIT

## Package Information

- **Description:** Renders highlighted Prism output using React
- **Repository:** https://github.com/FormidableLabs/prism-react-renderer
- **npm:** https://www.npmjs.com/package/prism-react-renderer
- **Maintainers:** Formidable Labs (formidablelabs, sarahformidable, scott-rippey,
  and others)
- **Published:** 2024-12-11
- **Registry Attestation:** SLSA provenance attestation available

## Runtime Dependencies

| Package        | Version  | Vulnerabilities |
| -------------- | -------- | --------------- |
| clsx           | ^2.0.0   | None known      |
| @types/prismjs | ^1.26.0  | None (types)    |

## Security Assessment

### Direct Vulnerabilities

**None found.** No security advisories exist for prism-react-renderer in:

- GitHub Security Advisories (GraphQL API query returned empty)
- npm audit database
- Snyk vulnerability database
- NVD (National Vulnerability Database)

### Bundled PrismJS Analysis

prism-react-renderer bundles a subset of PrismJS internally at build time
(listed as `prismjs: "1.29.0"` in devDependencies). This is important because
PrismJS has known vulnerabilities:

| CVE             | Severity | Affected Versions      | Fixed In | Description                                    |
| --------------- | -------- | ---------------------- | -------- | ---------------------------------------------- |
| CVE-2024-53382  | MODERATE | < 1.30.0               | 1.30.0   | DOM Clobbering leading to XSS                  |
| CVE-2022-23647  | HIGH     | 1.14.0 - 1.26.x        | 1.27.0   | XSS in Command line plugin                     |
| CVE-2021-32723  | HIGH     | < 1.24.0               | 1.24.0   | ReDoS in ASCIIDoc and ERB languages            |
| CVE-2021-23341  | HIGH     | < 1.23.0               | 1.23.0   | ReDoS in asciidoc, rest, tap, eiffel           |
| CVE-2021-3801   | MODERATE | < 1.25.0               | 1.25.0   | ReDoS via crafted HTML comments                |
| CVE-2020-15138  | HIGH     | 1.1.0 - 1.20.x         | 1.21.0   | XSS in Previewers plugin (Safari/IE)           |

**Mitigation Factors:**

1. prism-react-renderer bundles only a **subset** of PrismJS - it does not
   include all plugins or language definitions
2. The Command line plugin (CVE-2022-23647) is NOT bundled
3. The Previewers plugin (CVE-2020-15138) is NOT bundled
4. The library performs server-side or build-time rendering, reducing XSS
   exposure
5. The bundled version (1.29.0) is patched for CVE-2021-* vulnerabilities

**Remaining Risk:**

- CVE-2024-53382 (DOM Clobbering) affects PrismJS < 1.30.0
- The bundled version (1.29.0) is vulnerable to this issue
- Impact: Potential XSS when processing untrusted HTML input containing
  attacker-controlled elements that shadow `document.currentScript`
- Severity: Moderate (requires specific conditions)

## Recommendation

**APPROVED WITH CAVEATS**

The package is safe to use with the following considerations:

1. **Input Sanitization:** Never pass untrusted/user-supplied HTML directly to
   the highlighter. Only pass code strings that do not contain HTML.

2. **Future Update:** Monitor for prism-react-renderer updates that bundle
   PrismJS >= 1.30.0 to address CVE-2024-53382.

3. **Use Case:** The package is designed for syntax highlighting of code
   snippets, typically from trusted sources (documentation, markdown files).
   Using it for this purpose poses minimal risk.

## Version History

| Version | Released   | Notes                           |
| ------- | ---------- | ------------------------------- |
| 2.4.1   | 2024-12-11 | React Server Components support |
| 2.4.0   | 2024-08-29 | Feature update                  |
| 2.3.1   | 2023-12-18 | Bug fixes                       |
| 2.3.0   | 2023-11-21 | Feature update                  |
| 2.0.0   | 2023-04-24 | Major rewrite                   |

## Sources

- GitHub Security Advisory Database (GraphQL API)
- npm registry: https://registry.npmjs.org/prism-react-renderer
- GitHub repository: https://github.com/FormidableLabs/prism-react-renderer
- PrismJS vulnerabilities: https://github.com/advisories?query=prismjs
