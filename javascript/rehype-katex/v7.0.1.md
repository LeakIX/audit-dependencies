# Security Audit: rehype-katex v7.0.1

**Audit Date:** 2026-02-01
**Package:** [rehype-katex](https://www.npmjs.com/package/rehype-katex)
**Version:** 7.0.1
**License:** MIT

## Package Overview

rehype-katex is a rehype plugin to transform inline and block math with KaTeX.
It is part of the [remark-math](https://github.com/remarkjs/remark-math)
monorepo.

- **Repository:** https://github.com/remarkjs/remark-math
- **Last Published:** 2024-08-19
- **Weekly Downloads:** 1.6M+

## Maintainers

- remcohaszing (remcohaszing@gmail.com)
- johno (johnotander@gmail.com)
- wooorm (tituswormer@gmail.com)

## Dependencies

| Package                        | Version   |
| ------------------------------ | --------- |
| katex                          | ^0.16.0   |
| @types/hast                    | ^3.0.0    |
| @types/katex                   | ^0.16.0   |
| hast-util-from-html-isomorphic | ^2.0.0    |
| hast-util-to-text              | ^4.0.0    |
| unist-util-visit-parents       | ^6.0.0    |
| vfile                          | ^6.0.0    |

## Direct Vulnerabilities

**None reported** for rehype-katex v7.0.1.

Sources checked:

- [Snyk Advisor](https://snyk.io/advisor/npm-package/rehype-katex) - Health
  score 74/100, no known security issues
- [GitHub Advisory Database](https://github.com/advisories) - No advisories
  found
- [npm audit](https://www.npmjs.com/package/rehype-katex) - No known
  vulnerabilities

## Dependency Vulnerabilities

### katex (Transitive Dependency)

The katex dependency (^0.16.0) has known vulnerabilities that were fixed in
v0.16.10. Users of rehype-katex should ensure katex >= 0.16.10 is installed.

#### CVE-2024-28246 - Uppercase Protocol Bypass (XSS)

- **Severity:** Medium
- **Affected Versions:** < 0.16.10
- **Fixed Version:** 0.16.10
- **Description:** The trust option's URL protocol blacklist can be bypassed
  using uppercase characters in the protocol (e.g., `JAVASCRIPT:`). This allows
  generation of javascript: links even when the trust function forbids this
  protocol.
- **References:**
  - [Snyk Advisory](https://security.snyk.io/vuln/SNYK-JS-KATEX-6483834)
  - [CVE Details](https://www.cvedetails.com/cve/CVE-2024-28246/)

#### CVE-2024-28245 - \includegraphics XSS

- **Severity:** Medium
- **Affected Versions:** < 0.16.10
- **Fixed Version:** 0.16.10
- **Description:** Users rendering untrusted mathematical expressions could
  encounter malicious input using `\includegraphics` that runs arbitrary
  JavaScript or generates invalid HTML.
- **References:**
  - [CVE Details](https://www.cvedetails.com/cve/CVE-2024-28245/)

#### CVE-2024-28244 - maxExpand Bypass via Unicode Sub/Superscripts (DoS)

- **Severity:** Medium
- **Affected Versions:** < 0.16.10
- **Fixed Version:** 0.16.10
- **Description:** The maxExpand option can be bypassed using Unicode
  sub/superscript characters. Each sub/superscript group instantiates a separate
  Parser with its own limit, without inheriting the current count from its
  parent.
- **References:**
  - [GitHub Advisory GHSA-cvr6-37gx-v8wc](https://github.com/KaTeX/KaTeX/security/advisories/GHSA-cvr6-37gx-v8wc)

#### CVE-2024-28243 - maxExpand Bypass via \edef (DoS)

- **Severity:** Medium
- **Affected Versions:** < 0.16.10
- **Fixed Version:** 0.16.10
- **Description:** The `\edef` command can be used to build up an exponential
  number of tokens using only a linear number of expansions, bypassing the
  maxExpand limit.
- **References:**
  - [GitHub Advisory GHSA-64fm-8hw2-v72w](https://github.com/KaTeX/KaTeX/security/advisories/GHSA-64fm-8hw2-v72w)

## Recommendations

1. **Ensure katex >= 0.16.10** is installed to mitigate the 2024
   vulnerabilities. The rehype-katex dependency constraint `^0.16.0` allows
   vulnerable versions.

2. **Use rehype-sanitize** when rendering untrusted user input. The rehype-katex
   documentation explicitly warns about XSS risks.

3. **Consider allow-listing protocols** in your trust function instead of
   block-listing, and manually lowercase `context.protocol` before checking.

## Audit Summary

| Category              | Status                                        |
| --------------------- | --------------------------------------------- |
| Direct vulnerabilities | None                                         |
| Dependency vulnerabilities | 4 CVEs in katex < 0.16.10                |
| Maintenance status    | Inactive (last release 1+ year ago)           |
| License               | MIT (permissive)                              |
| Recommendation        | Safe to use with katex >= 0.16.10             |
